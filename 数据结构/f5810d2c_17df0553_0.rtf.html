<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"><head><style>/*<![CDATA[*/
table{border: 1px solid gray;} td{border: 1px dotted gray;} p{margin: 3px 0 3px 0; padding: 0;} #ID_Footer{font-size: small; font-style: italic;} a{padding-right: 20px; background: URL(./icon_newwin.gif) no-repeat center right;} a[href ^= "mailto:"]{padding: 0 20px 0 0; background: URL(./icon_email.gif) no-repeat center right;} a[href ^= "nyf:"]{padding: 0 20px 0 0; background: URL(./icon_jump.gif) no-repeat center right;} 
/*]]>*/</style><title>SQL强化</title></head><body>
<div><span style="font-family: Courier New; font-size: 10pt; font-weight: bold; color: #454545; padding-left: 18pt">1. &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="font-family: 宋体; font-size: 10pt; font-weight: bold; color: #454545; padding-left: 18pt">集合操作</span></div>
<div><span style="font-family: Courier New; font-size: 10pt; padding-left: 18pt">2. &nbsp; &nbsp; &nbsp; &nbsp;Rank()</span><span style="font-family: 宋体; font-size: 10pt; padding-left: 18pt">等操作</span></div>
<div><span style="font-family: Courier New; font-size: 10pt; padding-left: 18pt">3. &nbsp; &nbsp; &nbsp; &nbsp;Case when</span><span style="font-family: 宋体; font-size: 10pt; padding-left: 18pt">操作行转列</span></div>
<div><span style="font-family: Courier New; font-size: 10pt; padding-left: 18pt">4. &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="font-family: 宋体; font-size: 10pt; padding-left: 18pt">子查询</span></div>
<div><span style="font-family: Courier New; font-size: 10pt; padding-left: 18pt">5. &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="font-family: 宋体; font-size: 10pt; padding-left: 18pt">多表查询</span></div>
<div><span style="font-family: Courier New; font-size: 10pt; padding-left: 18pt">6. &nbsp; &nbsp; &nbsp; &nbsp;SQL</span><span style="font-family: 宋体; font-size: 10pt; padding-left: 18pt">优化</span></div>
<div><span style="font-family: Courier New; font-size: 10pt; padding-left: 18pt">7. &nbsp; &nbsp; &nbsp; &nbsp;Exist &nbsp;</span><span style="font-family: 宋体; font-size: 10pt; padding-left: 18pt">推荐方案：在业务密集的</span><span style="font-family: Courier New; font-size: 10pt; padding-left: 18pt">SQL</span><span style="font-family: 宋体; font-size: 10pt; padding-left: 18pt">当中尽量不采用</span><span style="font-family: Courier New; font-size: 10pt; padding-left: 18pt">IN</span><span style="font-family: 宋体; font-size: 10pt; padding-left: 18pt">操作符，用</span><span style="font-family: Courier New; font-size: 10pt; padding-left: 18pt">EXISTS </span><span style="font-family: 宋体; font-size: 10pt; padding-left: 18pt">方案代替</span></div>
<div><span style="font-family: Courier New; font-size: 10pt; padding-left: 18pt">8. &nbsp; &nbsp; &nbsp; &nbsp;</span></div>
<div><br /></div>
<div><span style="font-family: 宋体; font-size: 10pt; padding-left: 22pt">一、 &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="font-family: Courier New; font-size: 10pt; padding-left: 22pt">SQL</span><span style="font-family: 宋体; font-size: 10pt; padding-left: 22pt">语句的优化</span></div>
<div><br /></div>
<div><br /></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #333333">sql语句性能达不到你的要求，执行效率低，一般会是下面几种情况。</span></div>
<div><span style="font-family: Symbol; font-size: 10pt; padding-left: 22pt"></span><span style="font-family: 宋体; font-size: 11pt; padding-left: 22pt">网速不给力，不稳定。</span></div>
<div><span style="font-family: Symbol; font-size: 10pt; padding-left: 22pt"></span><span style="font-family: 宋体; font-size: 11pt; padding-left: 22pt">服务器内存不够，或者SQL 被分配的内存不够。</span></div>
<div><br /></div>
<div><span style="font-family: Symbol; font-size: 10pt; padding-left: 22pt"></span><span style="font-family: 宋体; font-size: 11pt; padding-left: 22pt">sql语句设计不合理</span></div>
<div><span style="font-family: Symbol; font-size: 10pt; padding-left: 22pt"></span><span style="font-family: 宋体; font-size: 11pt; padding-left: 22pt">没有相应的索引，索引不合理</span></div>
<div><span style="font-family: Symbol; font-size: 10pt; padding-left: 22pt"></span><span style="font-family: 宋体; font-size: 11pt; padding-left: 22pt">表数据过大没有有效的分区设计</span></div>
<div><span style="font-family: Symbol; font-size: 10pt; padding-left: 22pt"></span><span style="font-family: 宋体; font-size: 11pt; padding-left: 22pt">数据库设计糟糕，存在大量的数据冗余</span></div>
<div><br /></div>
<div><br /></div>
<div><br /></div>
<div><br /></div>
<div><br /></div>
<div><span style="font-family: Microsoft Yahei; font-size: 11pt; color: #333333">.</span><span style="font-family: 微软雅黑; font-size: 11pt; color: #333333">对查询进行优化，要尽量避免全表扫描，首先应考虑在</span><span style="font-family: Microsoft Yahei; font-size: 11pt; color: #333333"> where </span><span style="font-family: 微软雅黑; font-size: 11pt; color: #333333">及</span><span style="font-family: Microsoft Yahei; font-size: 11pt; color: #333333"> order by </span><span style="font-family: 微软雅黑; font-size: 11pt; color: #333333">涉及的列上建立索引。</span></div>
<div><br /></div>
<div><br /></div>
<div><br /></div>
<div><br /></div>
<div><br /></div>
<div><br /></div>
<div><br /></div>
<div><br /></div>
<div><br /></div>
<div><br /></div>
<div><br /></div>
<div><span style="font-family: Cambria; font-size: 10pt; padding-left: 14pt">1. &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="font-family: 宋体; font-size: 10pt; padding-left: 14pt">一道</span><span style="font-family: Cambria; font-size: 10pt; padding-left: 14pt">SQL</span><span style="font-family: 宋体; font-size: 10pt; padding-left: 14pt">语句面试题，关于</span><span style="font-family: Cambria; font-size: 10pt; padding-left: 14pt">group by</span><span style="font-family: 宋体; font-size: 10pt; padding-left: 14pt">。</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; padding-left: 18pt">表内容：</span><span style="font-family: Cambria; font-size: 11pt; padding-left: 18pt">2005-05-09 </span><span style="font-family: 宋体; font-size: 11pt; padding-left: 18pt">胜</span><span style="font-family: Cambria; font-size: 11pt; padding-left: 18pt">2005-05-09 </span><span style="font-family: 宋体; font-size: 11pt; padding-left: 18pt">胜</span><span style="font-family: Cambria; font-size: 11pt; padding-left: 18pt">2005-05-09 </span><span style="font-family: 宋体; font-size: 11pt; padding-left: 18pt">负</span><span style="font-family: Cambria; font-size: 11pt; padding-left: 18pt">2005-05-09 </span><span style="font-family: 宋体; font-size: 11pt; padding-left: 18pt">负</span><span style="font-family: Cambria; font-size: 11pt; padding-left: 18pt">2005-05-10 </span><span style="font-family: 宋体; font-size: 11pt; padding-left: 18pt">胜</span><span style="font-family: Cambria; font-size: 11pt; padding-left: 18pt">2005-05-10 </span><span style="font-family: 宋体; font-size: 11pt; padding-left: 18pt">负</span><span style="font-family: Cambria; font-size: 11pt; padding-left: 18pt">2005-05-10 </span><span style="font-family: 宋体; font-size: 11pt; padding-left: 18pt">负</span><span style="font-family: 宋体; font-size: 11pt; padding-left: 18pt">如果要生成下列结果</span><span style="font-family: Cambria; font-size: 11pt; padding-left: 18pt">, </span><span style="font-family: 宋体; font-size: 11pt; padding-left: 18pt">该如何写</span><span style="font-family: Cambria; font-size: 11pt; padding-left: 18pt">sql</span><span style="font-family: 宋体; font-size: 11pt; padding-left: 18pt">语句</span><span style="font-family: Cambria; font-size: 11pt; padding-left: 18pt">? &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span style="font-family: 宋体; font-size: 11pt; padding-left: 18pt">胜</span><span style="font-family: Cambria; font-size: 11pt; padding-left: 18pt"> </span><span style="font-family: 宋体; font-size: 11pt; padding-left: 18pt">负</span><span style="font-family: Cambria; font-size: 11pt; padding-left: 18pt">2005-05-09 2 22005-05-10 1 2</span></div>
<div><br /></div>
<div><span style="font-family: Cambria; font-size: 10pt; font-weight: bold; color: #454545; padding-left: 14pt; line-height: 131%">2. &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="font-family: 宋体; font-size: 10pt; font-weight: bold; color: #454545; padding-left: 14pt; line-height: 131%">一个面试中遇到的</span><span style="font-family: Cambria; font-size: 10pt; font-weight: bold; color: #454545; padding-left: 14pt; line-height: 131%">SQL</span><span style="font-family: 宋体; font-size: 10pt; font-weight: bold; color: #454545; padding-left: 14pt; line-height: 131%">语句的查询问题。</span><span style="font-family: 宋体; font-size: 11pt; padding-left: 14pt; line-height: 131%">表中有</span><span style="font-family: Cambria; font-size: 11pt; padding-left: 14pt; line-height: 131%">A B C</span><span style="font-family: 宋体; font-size: 11pt; padding-left: 14pt; line-height: 131%">三列</span><span style="font-family: Times New Roman; font-size: 11pt; padding-left: 14pt; line-height: 131%">,</span><span style="font-family: 宋体; font-size: 11pt; padding-left: 14pt; line-height: 131%">用</span><span style="font-family: Cambria; font-size: 11pt; padding-left: 14pt; line-height: 131%">SQL</span><span style="font-family: 宋体; font-size: 11pt; padding-left: 14pt; line-height: 131%">语句实现：当</span><span style="font-family: Cambria; font-size: 11pt; padding-left: 14pt; line-height: 131%">A</span><span style="font-family: 宋体; font-size: 11pt; padding-left: 14pt; line-height: 131%">列大于</span><span style="font-family: Cambria; font-size: 11pt; padding-left: 14pt; line-height: 131%">B</span><span style="font-family: 宋体; font-size: 11pt; padding-left: 14pt; line-height: 131%">列时选择</span><span style="font-family: Cambria; font-size: 11pt; padding-left: 14pt; line-height: 131%">A</span><span style="font-family: 宋体; font-size: 11pt; padding-left: 14pt; line-height: 131%">列否则选择</span><span style="font-family: Cambria; font-size: 11pt; padding-left: 14pt; line-height: 131%">B</span><span style="font-family: 宋体; font-size: 11pt; padding-left: 14pt; line-height: 131%">列，当</span><span style="font-family: Cambria; font-size: 11pt; padding-left: 14pt; line-height: 131%">B</span><span style="font-family: 宋体; font-size: 11pt; padding-left: 14pt; line-height: 131%">列大于</span><span style="font-family: Cambria; font-size: 11pt; padding-left: 14pt; line-height: 131%">C</span><span style="font-family: 宋体; font-size: 11pt; padding-left: 14pt; line-height: 131%">列时选择</span><span style="font-family: Cambria; font-size: 11pt; padding-left: 14pt; line-height: 131%">B</span><span style="font-family: 宋体; font-size: 11pt; padding-left: 14pt; line-height: 131%">列否则选择</span><span style="font-family: Cambria; font-size: 11pt; padding-left: 14pt; line-height: 131%">C</span><span style="font-family: 宋体; font-size: 11pt; padding-left: 14pt; line-height: 131%">列。</span></div>
<div><br /></div>
<div><span style="font-family: Cambria; font-size: 10pt; font-weight: bold; color: #454545; padding-left: 14pt; line-height: 131%">3. &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="font-family: 宋体; font-size: 10pt; font-weight: bold; color: #454545; padding-left: 14pt; line-height: 131%">面试题：一个日期判断的</span><span style="font-family: Cambria; font-size: 10pt; font-weight: bold; color: #454545; padding-left: 14pt; line-height: 131%">sql</span><span style="font-family: 宋体; font-size: 10pt; font-weight: bold; color: #454545; padding-left: 14pt; line-height: 131%">语句？</span><span style="font-family: 宋体; font-size: 11pt; padding-left: 14pt; line-height: 131%">请取出</span><span style="font-family: Cambria; font-size: 11pt; padding-left: 14pt; line-height: 131%">tb_send</span><span style="font-family: 宋体; font-size: 11pt; padding-left: 14pt; line-height: 131%">表中日期</span><span style="font-family: Cambria; font-size: 11pt; padding-left: 14pt; line-height: 131%">(SendTime</span><span style="font-family: 宋体; font-size: 11pt; padding-left: 14pt; line-height: 131%">字段</span><span style="font-family: Cambria; font-size: 11pt; padding-left: 14pt; line-height: 131%">)</span><span style="font-family: 宋体; font-size: 11pt; padding-left: 14pt; line-height: 131%">为当天的所有记录</span><span style="font-family: Cambria; font-size: 11pt; padding-left: 14pt; line-height: 131%">?(SendTime</span><span style="font-family: 宋体; font-size: 11pt; padding-left: 14pt; line-height: 131%">字段为</span><span style="font-family: Cambria; font-size: 11pt; padding-left: 14pt; line-height: 131%">datetime</span><span style="font-family: 宋体; font-size: 11pt; padding-left: 14pt; line-height: 131%">型，包含日期与时间</span><span style="font-family: Cambria; font-size: 11pt; padding-left: 14pt; line-height: 131%">)</span></div>
<div><br /></div>
<div><span style="font-family: Cambria; font-size: 10pt; font-weight: bold; color: #454545; padding-left: 14pt">4. &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="font-family: 宋体; font-size: 10pt; font-weight: bold; color: #454545; padding-left: 14pt">请用一个</span><span style="font-family: Cambria; font-size: 10pt; font-weight: bold; color: #454545; padding-left: 14pt">sql</span><span style="font-family: 宋体; font-size: 10pt; font-weight: bold; color: #454545; padding-left: 14pt">语句得出结果</span><span style="font-family: 微软雅黑; font-size: 10pt; color: #454545; padding-left: 14pt">从</span><span style="font-family: Cambria; font-size: 10pt; color: #454545; padding-left: 14pt">table1,table2</span><span style="font-family: 微软雅黑; font-size: 10pt; color: #454545; padding-left: 14pt">中取出如</span><span style="font-family: Cambria; font-size: 10pt; color: #454545; padding-left: 14pt">table3</span><span style="font-family: 微软雅黑; font-size: 10pt; color: #454545; padding-left: 14pt">所列格式数据，注意提供的数据及结果不准确，只是作为一个格式向大家请教。</span><span style="font-family: 微软雅黑; font-size: 10pt; color: #454545; padding-left: 14pt">如使用存储过程也可以。</span><span style="font-family: Cambria; font-size: 10pt; color: #454545; padding-left: 14pt">table1</span><span style="font-family: 微软雅黑; font-size: 10pt; color: #454545; padding-left: 14pt">部门</span><span style="font-family: Cambria; font-size: 10pt; color: #454545; padding-left: 14pt">dep &nbsp; &nbsp; </span><span style="font-family: 微软雅黑; font-size: 10pt; color: #454545; padding-left: 14pt">部门名称</span><span style="font-family: Cambria; font-size: 10pt; color: #454545; padding-left: 14pt">dname-------------------------------- &nbsp; &nbsp; 01 &nbsp; &nbsp; </span><span style="font-family: 微软雅黑; font-size: 10pt; color: #454545; padding-left: 14pt">国内业务一部</span><span style="font-family: Times New Roman; font-size: 10pt; color: #454545; padding-left: 14pt"> &nbsp; &nbsp; </span><span style="font-family: Cambria; font-size: 10pt; color: #454545; padding-left: 14pt"> 02 &nbsp; &nbsp; </span><span style="font-family: 微软雅黑; font-size: 10pt; color: #454545; padding-left: 14pt">国内业务二部</span><span style="font-family: Times New Roman; font-size: 10pt; color: #454545; padding-left: 14pt"> &nbsp; &nbsp; </span><span style="font-family: Cambria; font-size: 10pt; color: #454545; padding-left: 14pt"> 03 &nbsp; &nbsp; </span><span style="font-family: 微软雅黑; font-size: 10pt; color: #454545; padding-left: 14pt">国内业务三部</span><span style="font-family: Times New Roman; font-size: 10pt; color: #454545; padding-left: 14pt"> &nbsp; &nbsp; </span><span style="font-family: Cambria; font-size: 10pt; color: #454545; padding-left: 14pt"> 04 &nbsp; &nbsp; </span><span style="font-family: 微软雅黑; font-size: 10pt; color: #454545; padding-left: 14pt">国际业务部</span><span style="font-family: Cambria; font-size: 10pt; color: #454545; padding-left: 14pt">table2</span><span style="font-family: 微软雅黑; font-size: 10pt; color: #454545; padding-left: 14pt">月份</span><span style="font-family: Cambria; font-size: 10pt; color: #454545; padding-left: 14pt">mon </span><span style="font-family: 微软雅黑; font-size: 10pt; color: #454545; padding-left: 14pt">部门</span><span style="font-family: Cambria; font-size: 10pt; color: #454545; padding-left: 14pt">dep </span><span style="font-family: 微软雅黑; font-size: 10pt; color: #454545; padding-left: 14pt">业绩</span><span style="font-family: Cambria; font-size: 10pt; color: #454545; padding-left: 14pt">yj-------------------------------</span><span style="font-family: 微软雅黑; font-size: 10pt; color: #454545; padding-left: 14pt">一月份</span><span style="font-family: Times New Roman; font-size: 10pt; color: #454545; padding-left: 14pt"> &nbsp; &nbsp; </span><span style="font-family: Cambria; font-size: 10pt; color: #454545; padding-left: 14pt"> 01 &nbsp; &nbsp; 10</span><span style="font-family: 微软雅黑; font-size: 10pt; color: #454545; padding-left: 14pt">一月份</span><span style="font-family: Times New Roman; font-size: 10pt; color: #454545; padding-left: 14pt"> &nbsp; &nbsp; </span><span style="font-family: Cambria; font-size: 10pt; color: #454545; padding-left: 14pt"> 02 &nbsp; &nbsp; 10</span></div>
<div><br /></div>
<div><span style="font-family: 微软雅黑; font-size: 10pt">二月份</span><span style="font-family: Times New Roman; font-size: 10pt"> &nbsp; &nbsp; </span><span style="font-family: Cambria; font-size: 10pt"> 03 &nbsp; &nbsp; 5</span><span style="font-family: 微软雅黑; font-size: 10pt">二月份</span><span style="font-family: Times New Roman; font-size: 10pt"> &nbsp; &nbsp; </span><span style="font-family: Cambria; font-size: 10pt"> 02 &nbsp; &nbsp; 8</span><span style="font-family: 微软雅黑; font-size: 10pt">三月份</span><span style="font-family: Times New Roman; font-size: 10pt"> &nbsp; &nbsp; </span><span style="font-family: Cambria; font-size: 10pt"> 04 &nbsp; &nbsp; 9</span><span style="font-family: 微软雅黑; font-size: 10pt">三月份</span><span style="font-family: Times New Roman; font-size: 10pt"> &nbsp; &nbsp; </span><span style="font-family: Cambria; font-size: 10pt"> 03 &nbsp; &nbsp; 8table3 </span><span style="font-family: 微软雅黑; font-size: 10pt">（</span><span style="font-family: Cambria; font-size: 10pt">result</span><span style="font-family: 微软雅黑; font-size: 10pt">）</span><span style="font-family: 微软雅黑; font-size: 10pt">部门</span><span style="font-family: Cambria; font-size: 10pt">dep &nbsp; &nbsp;</span><span style="font-family: 微软雅黑; font-size: 10pt">一月份</span><span style="font-family: Times New Roman; font-size: 10pt"> &nbsp; &nbsp; </span><span style="font-family: Cambria; font-size: 10pt"> </span><span style="font-family: 微软雅黑; font-size: 10pt">二月份</span><span style="font-family: Times New Roman; font-size: 10pt"> &nbsp; &nbsp; </span><span style="font-family: Cambria; font-size: 10pt"> </span><span style="font-family: 微软雅黑; font-size: 10pt">三月份</span><span style="font-family: Times New Roman; font-size: 10pt">-------------------------------------- &nbsp; &nbsp; </span><span style="font-family: Cambria; font-size: 10pt"> 01 &nbsp; &nbsp; 10 &nbsp; &nbsp; &nbsp; null &nbsp; &nbsp; null &nbsp; &nbsp; 02 &nbsp; &nbsp; 10 &nbsp; &nbsp; &nbsp; &nbsp;8 &nbsp; &nbsp; &nbsp; null &nbsp; &nbsp; 03 &nbsp; &nbsp; null &nbsp; &nbsp; &nbsp;5 &nbsp; &nbsp; &nbsp; 8 &nbsp; &nbsp; 04 &nbsp; &nbsp; null &nbsp; &nbsp; null &nbsp; &nbsp; 9</span></div>
<div><span style="font-family: Times New Roman; font-size: 10pt">------------------------------------------</span></div>
<div><br /></div>
<div><br /></div>
<div><span style="font-family: Cambria; font-size: 10pt; padding-left: 21pt">5. &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="font-family: 宋体; font-size: 10pt; padding-left: 21pt">面试题：怎么把这样一个表儿</span><span style="font-family: Arial; font-size: 11pt; padding-left: 21pt">year &nbsp;amount1991 &nbsp; &nbsp; &nbsp;1991 &nbsp; &nbsp; &nbsp;1991 &nbsp; &nbsp; &nbsp;1991 &nbsp; &nbsp; &nbsp;1992 &nbsp; &nbsp; &nbsp;1992 &nbsp; &nbsp; &nbsp;1992 &nbsp; &nbsp; &nbsp;1992 &nbsp; &nbsp; &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; padding-left: 21pt">查成这样一个结果</span><span style="font-family: Arial; font-size: 11pt; padding-left: 21pt">year m1 &nbsp; &nbsp; &nbsp;1991 1.1 1.2 1.3 1.41992 2.1 2.2 2.3 2.4</span></div>
<div><br /></div>
<div><br /></div>
<div><span style="font-family: Cambria; font-size: 10pt; padding-left: 7pt">6. &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="font-family: 宋体; font-size: 10pt; padding-left: 7pt">用一条</span><span style="font-family: Cambria; font-size: 10pt; padding-left: 7pt">SQL</span><span style="font-family: 宋体; font-size: 10pt; padding-left: 7pt">语句查询出每门课都大于</span><span style="font-family: Cambria; font-size: 10pt; padding-left: 7pt">80</span><span style="font-family: 宋体; font-size: 10pt; padding-left: 7pt">分的学生姓名</span></div>
<div><span style="font-family: 宋体; font-size: 10pt">name &nbsp; &nbsp;张三</span><span style="font-family: Times New Roman; font-size: 10pt"> &nbsp; &nbsp; </span><span style="font-family: 宋体; font-size: 10pt">语文</span><span style="font-family: Times New Roman; font-size: 10pt"> &nbsp; &nbsp; &nbsp; </span><span style="font-family: 宋体; font-size: 10pt">81张三</span><span style="font-family: Times New Roman; font-size: 10pt"> &nbsp; &nbsp; </span><span style="font-family: 宋体; font-size: 10pt">数学</span><span style="font-family: Times New Roman; font-size: 10pt"> &nbsp; &nbsp; &nbsp; </span><span style="font-family: 宋体; font-size: 10pt">75李四</span><span style="font-family: Times New Roman; font-size: 10pt"> &nbsp; &nbsp; </span><span style="font-family: 宋体; font-size: 10pt">语文</span><span style="font-family: Times New Roman; font-size: 10pt"> &nbsp; &nbsp; &nbsp; </span><span style="font-family: 宋体; font-size: 10pt">76李四</span><span style="font-family: Times New Roman; font-size: 10pt"> &nbsp; &nbsp; </span><span style="font-family: 宋体; font-size: 10pt">数学</span><span style="font-family: Times New Roman; font-size: 10pt"> &nbsp; &nbsp; &nbsp; </span><span style="font-family: 宋体; font-size: 10pt">90王五</span><span style="font-family: Times New Roman; font-size: 10pt"> &nbsp; &nbsp; </span><span style="font-family: 宋体; font-size: 10pt">语文</span><span style="font-family: Times New Roman; font-size: 10pt"> &nbsp; &nbsp; &nbsp; </span><span style="font-family: 宋体; font-size: 10pt">81王五</span><span style="font-family: Times New Roman; font-size: 10pt"> &nbsp; &nbsp; </span><span style="font-family: 宋体; font-size: 10pt">数学</span><span style="font-family: Times New Roman; font-size: 10pt"> &nbsp; &nbsp; &nbsp; </span><span style="font-family: 宋体; font-size: 10pt">100王五</span><span style="font-family: Times New Roman; font-size: 10pt"> &nbsp; &nbsp; </span><span style="font-family: 宋体; font-size: 10pt">英语</span><span style="font-family: Times New Roman; font-size: 10pt"> &nbsp; &nbsp; &nbsp;</span><span style="font-family: Arial; font-size: 10pt"> </span><span style="font-family: 宋体; font-size: 10pt">90</span></div>
<div><br /></div>
<div><span style="font-family: Cambria; font-size: 10pt; padding-left: 7pt">7. &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="font-family: 宋体; font-size: 10pt; padding-left: 7pt">表形式如下：</span><span style="font-family: Times New Roman; font-size: 10pt; padding-left: 7pt"> </span><span style="font-family: Arial; font-size: 11pt; padding-left: 7pt">Year &nbsp; &nbsp; Salary 2000 &nbsp; &nbsp; &nbsp; 1000 2001 &nbsp; &nbsp; &nbsp; 2000 2002 &nbsp; &nbsp; &nbsp; 3000 2003 &nbsp; &nbsp; &nbsp; 4000 </span><span style="font-family: 宋体; font-size: 11pt; padding-left: 7pt">想得到如下形式的查询结果</span><span style="font-family: Times New Roman; font-size: 11pt; padding-left: 7pt"> </span><span style="font-family: Arial; font-size: 11pt; padding-left: 7pt">Year &nbsp; &nbsp; Salary 2000 &nbsp; &nbsp; 1000 2001 &nbsp; &nbsp; 3000 2002 &nbsp; &nbsp; 6000 2003 &nbsp; &nbsp; 10000 sql</span><span style="font-family: 宋体; font-size: 11pt; padding-left: 7pt">语句怎么写</span><span style="font-family: Arial; font-size: 11pt; padding-left: 7pt">? </span></div>
<div><br /></div>
<div><br /></div>
<div><br /></div>
<div><span style="font-family: Courier New; font-size: 10pt">1.</span><span style="font-family: 宋体; font-size: 10pt">一道</span><span style="font-family: Courier New; font-size: 10pt">SQL</span><span style="font-family: 宋体; font-size: 10pt">语句面试题，关于</span><span style="font-family: Courier New; font-size: 10pt">group by</span><span style="font-family: 微软雅黑; font-size: 11pt">表内容：</span><span style="font-family: Tahoma; font-size: 11pt">2005-05-09 </span><span style="font-family: 微软雅黑; font-size: 11pt">胜</span><span style="font-family: Tahoma; font-size: 11pt">2005-05-09 </span><span style="font-family: 微软雅黑; font-size: 11pt">胜</span><span style="font-family: Tahoma; font-size: 11pt">2005-05-09 </span><span style="font-family: 微软雅黑; font-size: 11pt">负</span><span style="font-family: Tahoma; font-size: 11pt">2005-05-09 </span><span style="font-family: 微软雅黑; font-size: 11pt">负</span><span style="font-family: Tahoma; font-size: 11pt">2005-05-10 </span><span style="font-family: 微软雅黑; font-size: 11pt">胜</span><span style="font-family: Tahoma; font-size: 11pt">2005-05-10 </span><span style="font-family: 微软雅黑; font-size: 11pt">负</span><span style="font-family: Tahoma; font-size: 11pt">2005-05-10 </span><span style="font-family: 微软雅黑; font-size: 11pt">负</span><span style="font-family: 微软雅黑; font-size: 11pt">如果要生成下列结果</span><span style="font-family: Tahoma; font-size: 11pt">, </span><span style="font-family: 微软雅黑; font-size: 11pt">该如何写</span><span style="font-family: Tahoma; font-size: 11pt">sql</span><span style="font-family: 微软雅黑; font-size: 11pt">语句</span><span style="font-family: Tahoma; font-size: 11pt">? &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span style="font-family: 微软雅黑; font-size: 11pt">胜</span><span style="font-family: Tahoma; font-size: 11pt"> </span><span style="font-family: 微软雅黑; font-size: 11pt">负</span><span style="font-family: Tahoma; font-size: 11pt">2005-05-09 2 22005-05-10 1 2</span></div>
<div><br /></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080; background-color: #ffffff">create</span><span style="font-family: 宋体; font-size: 11pt; color: #000000; background-color: #ffffff"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080; background-color: #ffffff">table</span><span style="font-family: 宋体; font-size: 11pt; color: #000000; background-color: #ffffff"> gameresult</span><span style="font-family: 宋体; font-size: 11pt; color: #000080; background-color: #ffffff">(</span></div>
<div><span style="font-family: 宋体; font-size: 11pt"> &nbsp; &nbsp; &nbsp;gameday </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">date</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span></div>
<div><span style="font-family: 宋体; font-size: 11pt"> &nbsp; &nbsp; &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">result</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">char</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">2</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #000080">);</span></div>
<div><br /></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">*</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> gameresult</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">;</span></div>
<div><br /></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">insert</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">into</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> gameresult </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">values</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #000000">to_date</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;2005-05-09&apos;</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;yyyy-mm-dd&apos;</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">),</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;胜&apos;</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">);</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">insert</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">into</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> gameresult </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">values</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #000000">to_date</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;2005-05-09&apos;</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;yyyy-mm-dd&apos;</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">),</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;胜&apos;</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">);</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">insert</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">into</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> gameresult </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">values</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #000000">to_date</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;2005-05-09&apos;</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;yyyy-mm-dd&apos;</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">),</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;负&apos;</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">);</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">insert</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">into</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> gameresult </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">values</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #000000">to_date</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;2005-05-09&apos;</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;yyyy-mm-dd&apos;</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">),</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;负&apos;</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">);</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">insert</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">into</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> gameresult </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">values</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #000000">to_date</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;2005-05-10&apos;</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;yyyy-mm-dd&apos;</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">),</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;胜&apos;</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">);</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">insert</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">into</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> gameresult </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">values</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #000000">to_date</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;2005-05-10&apos;</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;yyyy-mm-dd&apos;</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">),</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;负&apos;</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">);</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">insert</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">into</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> gameresult </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">values</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #000000">to_date</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;2005-05-10&apos;</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;yyyy-mm-dd&apos;</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">),</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;负&apos;</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">);</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">*</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> gameresult</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">;</span></div>
<div><br /></div>
<div><span style="font-family: Times New Roman; font-size: 11pt; font-style: italic; color: #ff0000">--</span><span style="font-family: 宋体; font-size: 11pt; font-style: italic; color: #ff0000">实现1：</span></div>
<div><span style="font-family: Times New Roman; font-size: 11pt">--</span><span style="font-family: 宋体; font-size: 11pt">获取胜利场次方法1</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> gameday</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">case</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">when</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">result</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;胜&apos;</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">then</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">1</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">else</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: Times New Roman; font-size: 11pt; color: #0000ff">0</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">end</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp; &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> gameresult</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">;</span></div>
<div><span style="font-family: Times New Roman; font-size: 11pt; font-style: italic; color: #ff0000">--</span><span style="font-family: 宋体; font-size: 11pt; font-style: italic; color: #ff0000">获取胜利场次方法2</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> gameday </span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">decode</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">result</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;胜&apos;</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">1</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: Times New Roman; font-size: 11pt; color: #0000ff">0</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> gameresult</span></div>
<div><span style="font-family: Times New Roman; font-size: 11pt; font-style: italic; color: #ff0000">--</span><span style="font-family: 宋体; font-size: 11pt; font-style: italic; color: #ff0000">执行最终查询结果</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span></div>
<div><span style="font-family: 宋体; font-size: 11pt"> &nbsp; &nbsp; &nbsp; to_char</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #000000">gameday</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;yyyy-mm-dd&apos;</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &quot;比赛日期&quot;</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span></div>
<div><span style="font-family: 宋体; font-size: 11pt"> &nbsp; &nbsp; &nbsp; </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">sum</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">case</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">when</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">result</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;胜&apos;</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">then</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">1</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">else</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: Times New Roman; font-size: 11pt; color: #0000ff">0</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">end</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &quot;胜&quot;</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span></div>
<div><span style="font-family: 宋体; font-size: 11pt"> &nbsp; &nbsp; &nbsp; </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">sum</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">decode</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">result</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;胜&apos;</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">1</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: Times New Roman; font-size: 11pt; color: #0000ff">0</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">))</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &quot;胜&quot;</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span></div>
<div><span style="font-family: 宋体; font-size: 11pt"> &nbsp; &nbsp; &nbsp; </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">sum</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">case</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">when</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">result</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;负&apos;</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">then</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">1</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">else</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: Times New Roman; font-size: 11pt; color: #0000ff">0</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">end</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &quot;负&quot;</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span></div>
<div><span style="font-family: 宋体; font-size: 11pt"> &nbsp; &nbsp; &nbsp; </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">count</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">result</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> 总场次</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> gameresult</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">group</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">by</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> gameday</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080; line-height: 131%">order</span><span style="font-family: 宋体; font-size: 11pt; color: #000000; line-height: 131%"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080; line-height: 131%">by</span><span style="font-family: 宋体; font-size: 11pt; color: #000000; line-height: 131%"> gameday </span><span style="font-family: 宋体; font-size: 11pt; color: #008080; line-height: 131%">desc</span></div>
<div><span style="font-family: Times New Roman; font-size: 11pt; font-style: italic; color: #ff0000; background-color: #ffffff">--</span><span style="font-family: 宋体; font-size: 11pt; font-style: italic; color: #ff0000; background-color: #ffffff">实现2：</span></div>
<div><span style="font-family: Times New Roman; font-size: 11pt">--</span><span style="font-family: 宋体; font-size: 11pt">统计胜利场次</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> gameday</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">count</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(*)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> 胜 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> gameresult </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">where</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">result</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;胜&apos;</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">group</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">by</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> gameday</span></div>
<div><br /></div>
<div><span style="font-family: Times New Roman; font-size: 11pt; font-style: italic; color: #ff0000">--</span><span style="font-family: 宋体; font-size: 11pt; font-style: italic; color: #ff0000">统计失败场次</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> gameday</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">count</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(*)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> 负 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> gameresult </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">where</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">result</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;负&apos;</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">group</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">by</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> gameday </span></div>
<div><br /></div>
<div><span style="font-family: Times New Roman; font-size: 11pt; font-style: italic; color: #ff0000">--</span><span style="font-family: 宋体; font-size: 11pt; font-style: italic; color: #ff0000">讲前面两个查询看做两张表，使用多表连接查询获取最终结果(SQL99)</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> gr1.gameday</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #000000">gr1.胜</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #000000">gr2.负 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> gameday</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">count</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(*)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> 胜 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> gameresult </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">where</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">result</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;胜&apos;</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">group</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">by</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> gameday </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> gr1</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">join</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> gameday</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">count</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(*)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> 负 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> gameresult </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">where</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">result</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;负&apos;</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">group</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">by</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> gameday </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> gr2</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">on</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> gr1.gameday </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> gr2.gameday</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080; line-height: 131%">order</span><span style="font-family: 宋体; font-size: 11pt; color: #000000; line-height: 131%"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080; line-height: 131%">by</span><span style="font-family: 宋体; font-size: 11pt; color: #000000; line-height: 131%"> gameday </span><span style="font-family: 宋体; font-size: 11pt; color: #008080; line-height: 131%">desc</span></div>
<div><span style="font-family: Times New Roman; font-size: 11pt; font-style: italic; color: #ff0000; background-color: #ffffff">--</span><span style="font-family: 宋体; font-size: 11pt; font-style: italic; color: #ff0000; background-color: #ffffff">讲前面两个查询看做两张表，使用多表连接查询获取最终结果（SQL92）</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> a.gameday</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #000000">a.a1 胜</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #000000">b.b1 负 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> gameday</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">count</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #000000">gameday</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> a1 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> gameresult </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">where</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">result</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;胜&apos;</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">group</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">by</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> gameday</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> a</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> gameday</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">count</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #000000">gameday</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> b1 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> gameresult </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">where</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">result</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;负&apos;</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">group</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">by</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> gameday</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> b</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080; line-height: 131%">where</span><span style="font-family: 宋体; font-size: 11pt; color: #000000; line-height: 131%"> a.gameday</span><span style="font-family: 宋体; font-size: 11pt; color: #000080; line-height: 131%">=</span><span style="font-family: 宋体; font-size: 11pt; color: #000000; line-height: 131%">b.gameday</span></div>
<div><span style="font-family: Times New Roman; font-size: 11pt; font-style: italic; color: #ff0000; background-color: #ffffff">--</span><span style="font-family: 宋体; font-size: 11pt; font-style: italic; color: #ff0000; background-color: #ffffff">讲前面两个查询看做两张表，使用多表连接查询获取最终结果（自然连接）</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">*</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> gameday</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">count</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(*)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> 胜 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> gameresult </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">where</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">result</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;胜&apos;</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">group</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">by</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> gameday</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span></div>
<div><span style="font-family: 宋体; font-size: 11pt"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">natural</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">join</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> gameday</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">count</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(*)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> 负 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> gameresult </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">where</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">result</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;负&apos;</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">group</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">by</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> gameday </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span></div>
<div><br /></div>
<div><br /></div>
<div><span style="font-family: 微软雅黑; font-size: 11pt; color: #454545; line-height: 131%">请教一个面试中遇到的</span><span style="font-family: Courier New; font-size: 11pt; color: #454545; line-height: 131%">SQL</span><span style="font-family: 微软雅黑; font-size: 11pt; color: #454545; line-height: 131%">语句的查询问题</span><span style="font-family: 微软雅黑; font-size: 11pt; color: #454545; line-height: 131%">表中有</span><span style="font-family: Courier New; font-size: 11pt; color: #454545; line-height: 131%">A B C</span><span style="font-family: 微软雅黑; font-size: 11pt; color: #454545; line-height: 131%">三列</span><span style="font-family: Courier New; font-size: 11pt; color: #454545; line-height: 131%">,</span><span style="font-family: 微软雅黑; font-size: 11pt; color: #454545; line-height: 131%">用</span><span style="font-family: Courier New; font-size: 11pt; color: #454545; line-height: 131%">SQL</span><span style="font-family: 微软雅黑; font-size: 11pt; color: #454545; line-height: 131%">语句实现：当</span><span style="font-family: Courier New; font-size: 11pt; color: #454545; line-height: 131%">A</span><span style="font-family: 微软雅黑; font-size: 11pt; color: #454545; line-height: 131%">列大于</span><span style="font-family: Courier New; font-size: 11pt; color: #454545; line-height: 131%">B</span><span style="font-family: 微软雅黑; font-size: 11pt; color: #454545; line-height: 131%">列时选择</span><span style="font-family: Courier New; font-size: 11pt; color: #454545; line-height: 131%">A</span><span style="font-family: 微软雅黑; font-size: 11pt; color: #454545; line-height: 131%">列否则选择</span><span style="font-family: Courier New; font-size: 11pt; color: #454545; line-height: 131%">B</span><span style="font-family: 微软雅黑; font-size: 11pt; color: #454545; line-height: 131%">列，当</span><span style="font-family: Courier New; font-size: 11pt; color: #454545; line-height: 131%">B</span><span style="font-family: 微软雅黑; font-size: 11pt; color: #454545; line-height: 131%">列大于</span><span style="font-family: Courier New; font-size: 11pt; color: #454545; line-height: 131%">C</span><span style="font-family: 微软雅黑; font-size: 11pt; color: #454545; line-height: 131%">列时选择</span><span style="font-family: Courier New; font-size: 11pt; color: #454545; line-height: 131%">B</span><span style="font-family: 微软雅黑; font-size: 11pt; color: #454545; line-height: 131%">列否则选择</span><span style="font-family: Courier New; font-size: 11pt; color: #454545; line-height: 131%">C</span><span style="font-family: 微软雅黑; font-size: 11pt; color: #454545; line-height: 131%">列。</span></div>
<div><span style="font-family: Times New Roman; font-size: 11pt; font-style: italic; color: #ff0000; background-color: #ffffff">--</span><span style="font-family: 宋体; font-size: 11pt; font-style: italic; color: #ff0000; background-color: #ffffff">显示两列</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp;</span></div>
<div><span style="font-family: 宋体; font-size: 11pt"> &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">case</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">when</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> a</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">&gt;</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> b </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">then</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> a </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">else</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> b </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">end</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">),</span></div>
<div><span style="font-family: 宋体; font-size: 11pt"> &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">case</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">when</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> b</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">&gt;</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> c </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">then</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> b </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">else</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> c </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">end</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1</span></div>
<div><br /></div>
<div><span style="font-family: Times New Roman; font-size: 11pt; font-style: italic; color: #ff0000">--</span><span style="font-family: 宋体; font-size: 11pt; font-style: italic; color: #ff0000">显示一列</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp;</span></div>
<div><span style="font-family: 宋体; font-size: 11pt"> &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">case</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">when</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> a</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">&gt;</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> b </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">then</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> a </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">else</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> b </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">end</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">),</span></div>
<div><span style="font-family: 宋体; font-size: 11pt"> &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">case</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">when</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> a</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">&gt;</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> b </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">then</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">case</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">when</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> a</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">&gt;</span><span style="font-family: 宋体; font-size: 11pt; color: #000000">c </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">then</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> a </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">else</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> c </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">end</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">else</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">case</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">when</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> b</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">&gt;</span><span style="font-family: 宋体; font-size: 11pt; color: #000000">c </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">then</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> b </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">else</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> c </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">end</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">end</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080; line-height: 131%">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000; line-height: 131%"> table1</span></div>
<div><span style="font-family: 微软雅黑; font-size: 11pt; color: #454545; line-height: 131%">面试题：一个日期判断的</span><span style="font-family: Courier New; font-size: 11pt; color: #454545; line-height: 131%">sql</span><span style="font-family: 微软雅黑; font-size: 11pt; color: #454545; line-height: 131%">语句？</span><span style="font-family: 微软雅黑; font-size: 11pt; color: #454545; line-height: 131%">请取出</span><span style="font-family: Courier New; font-size: 11pt; color: #454545; line-height: 131%">tb_send</span><span style="font-family: 微软雅黑; font-size: 11pt; color: #454545; line-height: 131%">表中日期</span><span style="font-family: Courier New; font-size: 11pt; color: #454545; line-height: 131%">(SendTime</span><span style="font-family: 微软雅黑; font-size: 11pt; color: #454545; line-height: 131%">字段</span><span style="font-family: Courier New; font-size: 11pt; color: #454545; line-height: 131%">)</span><span style="font-family: 微软雅黑; font-size: 11pt; color: #454545; line-height: 131%">为当天的所有记录</span><span style="font-family: Courier New; font-size: 11pt; color: #454545; line-height: 131%">?(SendTime</span><span style="font-family: 微软雅黑; font-size: 11pt; color: #454545; line-height: 131%">字段为</span><span style="font-family: Courier New; font-size: 11pt; color: #454545; line-height: 131%">datetime</span><span style="font-family: 微软雅黑; font-size: 11pt; color: #454545; line-height: 131%">型，包含日期与时间</span><span style="font-family: Courier New; font-size: 11pt; color: #454545; line-height: 131%">)</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080; background-color: #ffffff">create</span><span style="font-family: 宋体; font-size: 11pt; color: #000000; background-color: #ffffff"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080; background-color: #ffffff">table</span><span style="font-family: 宋体; font-size: 11pt; color: #000000; background-color: #ffffff"> table2</span><span style="font-family: 宋体; font-size: 11pt; color: #000080; background-color: #ffffff">(</span></div>
<div><span style="font-family: 宋体; font-size: 11pt"> &nbsp; &nbsp; &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">id</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">number</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">10</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">primary</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">key</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span></div>
<div><span style="font-family: 宋体; font-size: 11pt"> &nbsp; &nbsp; &nbsp;enterdate </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">date</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #000080">);</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">*</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table2</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">;</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">create</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">sequence</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> seq_table2 </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">;</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">insert</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">into</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table2 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">values</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #000000">seq_table2.nextval</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">sysdate</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">);</span></div>
<div><br /></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080; line-height: 131%">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000; line-height: 131%"> </span><span style="font-family: 宋体; font-size: 11pt; color: #000080; line-height: 131%">*</span><span style="font-family: 宋体; font-size: 11pt; color: #000000; line-height: 131%"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080; line-height: 131%">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000; line-height: 131%"> table2 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080; line-height: 131%">for</span><span style="font-family: 宋体; font-size: 11pt; color: #000000; line-height: 131%"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080; line-height: 131%">update</span><span style="font-family: 宋体; font-size: 11pt; color: #000080; line-height: 131%">;</span></div>
<div><span style="font-family: Times New Roman; font-size: 11pt; font-style: italic; color: #ff0000; background-color: #ffffff; line-height: 131%">--</span><span style="font-family: 宋体; font-size: 11pt; font-style: italic; color: #ff0000; background-color: #ffffff; line-height: 131%">修改日期出错 is not a valid date and time</span><span style="font-family: 宋体; font-size: 11pt; font-style: italic; color: #ff0000; line-height: 131%"> 更改日期和时间格式</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080; background-color: #ffffff">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000; background-color: #ffffff"> t2.</span><span style="font-family: 宋体; font-size: 11pt; color: #000080; background-color: #ffffff">*,</span><span style="font-family: 宋体; font-size: 11pt; color: #008080; background-color: #ffffff">sysdate</span><span style="font-family: 宋体; font-size: 11pt; color: #000000; background-color: #ffffff"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080; background-color: #ffffff">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000; background-color: #ffffff"> table2 t2</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080; line-height: 131%">where</span><span style="font-family: 宋体; font-size: 11pt; color: #000000; line-height: 131%"> to_char</span><span style="font-family: 宋体; font-size: 11pt; color: #000080; line-height: 131%">(</span><span style="font-family: 宋体; font-size: 11pt; color: #000000; line-height: 131%">enterdate</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080; line-height: 131%">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff; line-height: 131%">&apos;yyyymmdd&apos;</span><span style="font-family: 宋体; font-size: 11pt; color: #000080; line-height: 131%">)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000; line-height: 131%"> </span><span style="font-family: 宋体; font-size: 11pt; color: #000080; line-height: 131%">=</span><span style="font-family: 宋体; font-size: 11pt; color: #000000; line-height: 131%"> to_char</span><span style="font-family: 宋体; font-size: 11pt; color: #000080; line-height: 131%">(</span><span style="font-family: 宋体; font-size: 11pt; color: #008080; line-height: 131%">sysdate</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080; line-height: 131%">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff; line-height: 131%">&apos;yyyymmdd&apos;</span><span style="font-family: 宋体; font-size: 11pt; color: #000080; line-height: 131%">)</span></div>
<div><span style="font-family: Times New Roman; font-size: 11pt; font-style: italic; color: #ff0000; background-color: #ffffff; line-height: 131%">--</span><span style="font-family: 宋体; font-size: 11pt; font-style: italic; color: #ff0000; background-color: #ffffff; line-height: 131%">datediff SQL Server和MySQL</span></div>
<div><br /></div>
<div><span style="font-family: 微软雅黑; font-size: 11pt; color: #454545; line-height: 131%">一张成绩表，里面有</span><span style="font-family: Courier New; font-size: 11pt; color: #454545; line-height: 131%">3</span><span style="font-family: 微软雅黑; font-size: 11pt; color: #454545; line-height: 131%">个字段：语文，数学，英语。请用一条</span><span style="font-family: Courier New; font-size: 11pt; color: #454545; line-height: 131%">sql</span><span style="font-family: 微软雅黑; font-size: 11pt; color: #454545; line-height: 131%">语句查询这表里的记录并按以下条件显示出来：</span><span style="font-family: Courier New; font-size: 11pt; color: #454545; line-height: 131%"> </span><span style="font-family: 微软雅黑; font-size: 11pt; color: #454545; line-height: 131%">大于或等于</span><span style="font-family: Courier New; font-size: 11pt; color: #454545; line-height: 131%">80</span><span style="font-family: 微软雅黑; font-size: 11pt; color: #454545; line-height: 131%">表示优秀，大于或等于</span><span style="font-family: Courier New; font-size: 11pt; color: #454545; line-height: 131%">60</span><span style="font-family: 微软雅黑; font-size: 11pt; color: #454545; line-height: 131%">表示及格，小于</span><span style="font-family: Courier New; font-size: 11pt; color: #454545; line-height: 131%">60</span><span style="font-family: 微软雅黑; font-size: 11pt; color: #454545; line-height: 131%">分表示不及格。</span></div>
<div><span style="font-family: Courier New; font-size: 11pt; line-height: 131%"> &nbsp; &nbsp; &nbsp;</span><span style="font-family: 微软雅黑; font-size: 11pt; line-height: 131%">显示格式：</span><span style="font-family: Courier New; font-size: 11pt; line-height: 131%"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="font-family: 微软雅黑; font-size: 11pt; line-height: 131%">语文</span><span style="font-family: Courier New; font-size: 11pt; line-height: 131%"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span style="font-family: 微软雅黑; font-size: 11pt; line-height: 131%">数学</span><span style="font-family: Courier New; font-size: 11pt; line-height: 131%"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span style="font-family: 微软雅黑; font-size: 11pt; line-height: 131%">英语</span><span style="font-family: Courier New; font-size: 11pt; line-height: 131%"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="font-family: 微软雅黑; font-size: 11pt; line-height: 131%">及格</span><span style="font-family: Courier New; font-size: 11pt; line-height: 131%"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span style="font-family: 微软雅黑; font-size: 11pt; line-height: 131%">优秀</span><span style="font-family: Courier New; font-size: 11pt; line-height: 131%"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span style="font-family: 微软雅黑; font-size: 11pt; line-height: 131%">不及格</span><span style="font-family: Courier New; font-size: 11pt; line-height: 131%"> &nbsp; &nbsp;</span></div>
<div><br /></div>
<div><br /></div>
<div><br /></div>
<div><span style="font-family: 微软雅黑; font-size: 12pt">请用一个</span><span style="font-family: Courier New; font-size: 12pt">sql</span><span style="font-family: 微软雅黑; font-size: 12pt">语句得出结果</span><span style="font-family: 微软雅黑; font-size: 12pt">从</span><span style="font-family: Courier New; font-size: 12pt">table1,table2</span><span style="font-family: 微软雅黑; font-size: 12pt">中取出如</span><span style="font-family: Courier New; font-size: 12pt">table3</span><span style="font-family: 微软雅黑; font-size: 12pt">所列格式数据，注意提供的数据及结果不准确，只是作为一个格式向大家请教。</span><span style="font-family: 微软雅黑; font-size: 12pt">如使用存储过程也可以。</span><span style="font-family: Courier New; font-size: 12pt">table1</span><span style="font-family: 微软雅黑; font-size: 12pt">部门</span><span style="font-family: Courier New; font-size: 12pt">dep &nbsp; &nbsp; </span><span style="font-family: 微软雅黑; font-size: 12pt">部门名称</span><span style="font-family: Courier New; font-size: 12pt">dname-------------------------------- &nbsp; &nbsp; 01 &nbsp; &nbsp; </span><span style="font-family: 微软雅黑; font-size: 12pt">国内业务一部</span><span style="font-family: Times New Roman; font-size: 12pt"> &nbsp; &nbsp; </span><span style="font-family: Courier New; font-size: 12pt"> 02 &nbsp; &nbsp; </span><span style="font-family: 微软雅黑; font-size: 12pt">国内业务二部</span><span style="font-family: Times New Roman; font-size: 12pt"> &nbsp; &nbsp; </span><span style="font-family: Courier New; font-size: 12pt"> 03 &nbsp; &nbsp; </span><span style="font-family: 微软雅黑; font-size: 12pt">国内业务三部</span><span style="font-family: Times New Roman; font-size: 12pt"> &nbsp; &nbsp; </span><span style="font-family: Courier New; font-size: 12pt"> 04 &nbsp; &nbsp; </span><span style="font-family: 微软雅黑; font-size: 12pt">国际业务部</span><span style="font-family: Courier New; font-size: 12pt">table2</span><span style="font-family: 微软雅黑; font-size: 12pt">月份</span><span style="font-family: Courier New; font-size: 12pt">mon </span><span style="font-family: 微软雅黑; font-size: 12pt">部门</span><span style="font-family: Courier New; font-size: 12pt">dep </span><span style="font-family: 微软雅黑; font-size: 12pt">业绩</span><span style="font-family: Courier New; font-size: 12pt">yj-------------------------------</span><span style="font-family: 微软雅黑; font-size: 12pt">一月份</span><span style="font-family: Times New Roman; font-size: 12pt"> &nbsp; &nbsp; </span><span style="font-family: Courier New; font-size: 12pt"> 01 &nbsp; &nbsp; 10</span><span style="font-family: 微软雅黑; font-size: 12pt">一月份</span><span style="font-family: Times New Roman; font-size: 12pt"> &nbsp; &nbsp; </span><span style="font-family: Courier New; font-size: 12pt"> 02 &nbsp; &nbsp; 10</span></div>
<div><br /></div>
<div><span style="font-family: 微软雅黑; font-size: 12pt">二月份</span><span style="font-family: Times New Roman; font-size: 12pt"> &nbsp; &nbsp; </span><span style="font-family: Courier New; font-size: 12pt"> 03 &nbsp; &nbsp; 5</span><span style="font-family: 微软雅黑; font-size: 12pt">二月份</span><span style="font-family: Times New Roman; font-size: 12pt"> &nbsp; &nbsp; </span><span style="font-family: Courier New; font-size: 12pt"> 02 &nbsp; &nbsp; 8</span><span style="font-family: 微软雅黑; font-size: 12pt">三月份</span><span style="font-family: Times New Roman; font-size: 12pt"> &nbsp; &nbsp; </span><span style="font-family: Courier New; font-size: 12pt"> 04 &nbsp; &nbsp; 9</span><span style="font-family: 微软雅黑; font-size: 12pt">三月份</span><span style="font-family: Times New Roman; font-size: 12pt"> &nbsp; &nbsp; </span><span style="font-family: Courier New; font-size: 12pt"> 03 &nbsp; &nbsp; 8table3 </span><span style="font-family: 微软雅黑; font-size: 12pt">（</span><span style="font-family: Courier New; font-size: 12pt">result</span><span style="font-family: 微软雅黑; font-size: 12pt">）</span><span style="font-family: 微软雅黑; font-size: 12pt">部门</span><span style="font-family: Courier New; font-size: 12pt">dep &nbsp; &nbsp;</span><span style="font-family: 微软雅黑; font-size: 12pt">一月份</span><span style="font-family: Times New Roman; font-size: 12pt"> &nbsp; &nbsp; </span><span style="font-family: Courier New; font-size: 12pt"> </span><span style="font-family: 微软雅黑; font-size: 12pt">二月份</span><span style="font-family: Times New Roman; font-size: 12pt"> &nbsp; &nbsp; </span><span style="font-family: Courier New; font-size: 12pt"> </span><span style="font-family: 微软雅黑; font-size: 12pt">三月份</span><span style="font-family: Times New Roman; font-size: 12pt">-------------------------------------- &nbsp; &nbsp; </span><span style="font-family: Courier New; font-size: 12pt"> 01 &nbsp; &nbsp; 10 &nbsp; &nbsp; &nbsp; null &nbsp; &nbsp; null &nbsp; &nbsp; 02 &nbsp; &nbsp; 10 &nbsp; &nbsp; &nbsp; &nbsp;8 &nbsp; &nbsp; &nbsp; null &nbsp; &nbsp; 03 &nbsp; &nbsp; null &nbsp; &nbsp; &nbsp;5 &nbsp; &nbsp; &nbsp; 8 &nbsp; &nbsp; 04 &nbsp; &nbsp; null &nbsp; &nbsp; null &nbsp; &nbsp; 9</span></div>
<div><span style="font-family: Times New Roman; font-size: 12pt">------------------------------------------</span></div>
<div><br /></div>
<div><span style="font-family: 宋体; font-size: 11pt">create</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">table</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span></div>
<div><span style="font-family: 宋体; font-size: 11pt"> &nbsp; &nbsp; tno </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">varchar2</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">2</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">primary</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">key</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span></div>
<div><span style="font-family: 宋体; font-size: 11pt"> &nbsp; &nbsp; tname </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">varchar2</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">20</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">not</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">null</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span></div>
<div><br /></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">insert</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">into</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">values</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;01&apos;</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;国内业务一部&apos;</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">);</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">insert</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">into</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">values</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;02&apos;</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;国内业务二部&apos;</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">);</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">insert</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">into</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">values</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;03&apos;</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;国内业务三部&apos;</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">);</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">insert</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">into</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">values</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;04&apos;</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;国际业务部&apos;</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">);</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">commit</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">;</span></div>
<div><br /></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">*</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">;</span></div>
<div><br /></div>
<div><br /></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">create</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">table</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table2</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span></div>
<div><span style="font-family: 宋体; font-size: 11pt"> &nbsp;mon &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">varchar2</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">6</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">),</span></div>
<div><span style="font-family: 宋体; font-size: 11pt"> &nbsp;dept </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">varchar2</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">2</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">),</span></div>
<div><span style="font-family: 宋体; font-size: 11pt"> &nbsp;yj &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">number</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">2</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span></div>
<div><br /></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #000080">);</span></div>
<div><br /></div>
<div><br /></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">insert</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">into</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table2 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">values</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;一月份&apos;</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;01&apos;</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">10</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">);</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">insert</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">into</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table2 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">values</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;一月份&apos;</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;02&apos;</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">10</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">);</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">insert</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">into</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table2 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">values</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;二月份&apos;</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;03&apos;</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">5</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">);</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">insert</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">into</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table2 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">values</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;二月份&apos;</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;02&apos;</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">8</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">);</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">insert</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">into</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table2 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">values</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;三月份&apos;</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;04&apos;</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">9</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">);</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">insert</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">into</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table2 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">values</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;三月份&apos;</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;03&apos;</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">8</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">);</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">commit</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">;</span></div>
<div><br /></div>
<div><br /></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">*</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table2</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">;</span></div>
<div><br /></div>
<div><span style="font-family: Times New Roman; font-size: 11pt; font-style: italic; color: #ff0000; background-color: #ffffff">--</span><span style="font-family: 宋体; font-size: 11pt; font-style: italic; color: #ff0000; background-color: #ffffff">思路1：不使用group by</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> tno</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #000000">tname</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #000000">b.yj 一月份</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #000000">c.yj 二月份</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #000000">d.yj 三月份</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 a</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">left</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">join</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table2 b</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">on</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> a.tno </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> b.dept </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">and</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> b.mon</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;一月份&apos;</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">left</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">join</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp;table2 &nbsp;c</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">on</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> a.tno </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> c.dept </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">and</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> c.mon </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;二月份&apos;</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">left</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">join</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp;table2 &nbsp;d</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">on</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> a.tno </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> d.dept </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">and</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> d.mon </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;三月份&apos;</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">order</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">by</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> tno</span></div>
<div><br /></div>
<div><span style="font-family: Times New Roman; font-size: 11pt; font-style: italic; color: #ff0000; background-color: #ffffff">--</span><span style="font-family: 宋体; font-size: 11pt; font-style: italic; color: #ff0000; background-color: #ffffff">思路2：使用group by</span></div>
<div><span style="font-family: Times New Roman; font-size: 11pt">--</span><span style="font-family: 宋体; font-size: 11pt">一个月份多条记录</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span></div>
<div><span style="font-family: 宋体; font-size: 11pt"> &nbsp; &nbsp; &nbsp; tno </span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span></div>
<div><span style="font-family: 宋体; font-size: 11pt"> &nbsp; &nbsp; &nbsp; </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">case</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">when</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> mon </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;一月份&apos;</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">then</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> yj </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">else</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">null</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">end</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> 一月份</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span></div>
<div><span style="font-family: 宋体; font-size: 11pt"> &nbsp; &nbsp; &nbsp; </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">case</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">when</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> mon </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;二月份&apos;</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">then</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> yj </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">else</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">null</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">end</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> 二月份</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span></div>
<div><span style="font-family: 宋体; font-size: 11pt"> &nbsp; &nbsp; &nbsp; </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">case</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">when</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> mon </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;三月份&apos;</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">then</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> yj </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">else</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">null</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">end</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> 三月份</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 t1</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">join</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table2 t2</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">on</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t1.tno </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t2.dept</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">order</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">by</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> tno</span></div>
<div><br /></div>
<div><span style="font-family: Times New Roman; font-size: 11pt; font-style: italic; color: #ff0000">--</span><span style="font-family: 宋体; font-size: 11pt; font-style: italic; color: #ff0000">最终结果</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span></div>
<div><span style="font-family: 宋体; font-size: 11pt"> &nbsp; &nbsp; &nbsp; tno </span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span></div>
<div><span style="font-family: 宋体; font-size: 11pt"> &nbsp; &nbsp; &nbsp; </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">sum</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">case</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">when</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> mon </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;一月份&apos;</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">then</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> yj </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">else</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">null</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">end</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> 一月份</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span></div>
<div><span style="font-family: 宋体; font-size: 11pt"> &nbsp; &nbsp; &nbsp; </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">sum</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">case</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">when</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> mon </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;二月份&apos;</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">then</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> yj </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">else</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">null</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">end</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> 二月份</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span></div>
<div><span style="font-family: 宋体; font-size: 11pt"> &nbsp; &nbsp; &nbsp; </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">sum</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">case</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">when</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> mon </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;三月份&apos;</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">then</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> yj </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">else</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">null</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">end</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> 三月份</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 t1</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">join</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table2 t2</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">on</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t1.tno </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t2.dept</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">group</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">by</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> tno</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">order</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">by</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> tno</span></div>
<div><br /></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #454545">面试题：怎么把这样一个表儿</span><span style="font-family: Arial; font-size: 11pt; color: #454545">year &nbsp;amount1991 &nbsp; &nbsp; &nbsp;1991 &nbsp; &nbsp; &nbsp;1991 &nbsp; &nbsp; &nbsp;1991 &nbsp; &nbsp; &nbsp;1992 &nbsp; &nbsp; &nbsp;1992 &nbsp; &nbsp; &nbsp;1992 &nbsp; &nbsp; &nbsp;1992 &nbsp; &nbsp; &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; color: #454545">查成这样一个结果</span><span style="font-family: Arial; font-size: 11pt; color: #454545">year m1 &nbsp; &nbsp; &nbsp;1991 1.1 1.2 1.3 1.41992 2.1 2.2 2.3 2.4</span></div>
<div><br /></div>
<div><br /></div>
<div><br /></div>
<div><br /></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080; background-color: #ffffff">create</span><span style="font-family: 宋体; font-size: 11pt; color: #000000; background-color: #ffffff"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080; background-color: #ffffff">table</span><span style="font-family: 宋体; font-size: 11pt; color: #000000; background-color: #ffffff"> table1</span><span style="font-family: 宋体; font-size: 11pt; color: #000080; background-color: #ffffff">(</span></div>
<div><span style="font-family: 宋体; font-size: 11pt"> &nbsp; &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">year</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">number</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">4</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">),</span></div>
<div><span style="font-family: 宋体; font-size: 11pt"> &nbsp; &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">month</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">number</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">2</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">),</span></div>
<div><span style="font-family: 宋体; font-size: 11pt"> &nbsp; &nbsp;amount </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">number</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">3</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">1</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #000080">);</span></div>
<div><br /></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">insert</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">into</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">values</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">1991</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">1</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">1.1</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">);</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">insert</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">into</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">values</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">1991</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">2</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">1.2</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">);</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">insert</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">into</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">values</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">1991</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">3</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">1.3</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">);</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">insert</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">into</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">values</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">1991</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">4</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">1.4</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">);</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">insert</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">into</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">values</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">1992</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">1</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">2.1</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">);</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">insert</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">into</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">values</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">1992</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">2</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">2.2</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">);</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">insert</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">into</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">values</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">1992</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">3</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">2.3</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">);</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">insert</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">into</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">values</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">1992</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">4</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">2.4</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">);</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">commit</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">;</span></div>
<div><br /></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">*</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">;</span></div>
<div><br /></div>
<div><span style="font-family: Times New Roman; font-size: 11pt; font-style: italic; color: #ff0000; background-color: #ffffff">--</span><span style="font-family: 宋体; font-size: 11pt; font-style: italic; color: #ff0000; background-color: #ffffff">第一步</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span></div>
<div><span style="font-family: 宋体; font-size: 11pt">t1.year</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">case</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">when</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t1.month</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">1</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">then</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t1.amount </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">else</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: Times New Roman; font-size: 11pt; color: #0000ff">0</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">end</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> m1</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">case</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">when</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t1.month</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">2</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">then</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t1.amount </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">else</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: Times New Roman; font-size: 11pt; color: #0000ff">0</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">end</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> m2</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">case</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">when</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t1.month</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">3</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">then</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t1.amount </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">else</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: Times New Roman; font-size: 11pt; color: #0000ff">0</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">end</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> m3 </span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">case</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">when</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t1.month</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">3</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">then</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t1.amount </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">else</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: Times New Roman; font-size: 11pt; color: #0000ff">0</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">end</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> m4</span></div>
<div><span style="font-family: 宋体; font-size: 11pt"> &nbsp;</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 t1</span></div>
<div><br /></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">join</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 t2</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">on</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t1.year </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t2.year </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">and</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t1.month </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t2.month &nbsp;</span></div>
<div><br /></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">join</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 t3</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">on</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t1.year </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t3.year </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">and</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t1.month </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t3.month </span></div>
<div><br /></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">join</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 t4</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">on</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t1.year </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t4.year </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">and</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t1.month </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t4.month </span></div>
<div><br /></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">join</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 t5</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">on</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t1.year </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t5.year </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">and</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t1.month </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t5.month</span></div>
<div><br /></div>
<div><span style="font-family: Times New Roman; font-size: 11pt; font-style: italic; color: #ff0000; background-color: #ffffff">--</span><span style="font-family: 宋体; font-size: 11pt; font-style: italic; color: #ff0000; background-color: #ffffff">第二步：最终结果</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span></div>
<div><span style="font-family: 宋体; font-size: 11pt">t1.year </span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">sum</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">case</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">when</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t1.month</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">1</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">then</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t1.amount </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">else</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: Times New Roman; font-size: 11pt; color: #0000ff">0</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">end</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> m1</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">sum</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">case</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">when</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t1.month</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">2</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">then</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t1.amount </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">else</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: Times New Roman; font-size: 11pt; color: #0000ff">0</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">end</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> m2</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">sum</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">case</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">when</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t1.month</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">3</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">then</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t1.amount </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">else</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: Times New Roman; font-size: 11pt; color: #0000ff">0</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">end</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> m3 </span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">sum</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">case</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">when</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t1.month</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">3</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">then</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t1.amount </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">else</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: Times New Roman; font-size: 11pt; color: #0000ff">0</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">end</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> m4</span></div>
<div><span style="font-family: 宋体; font-size: 11pt"> &nbsp;</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 t1</span></div>
<div><br /></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">join</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 t2</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">on</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t1.year </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t2.year </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">and</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t1.month </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t2.month &nbsp;</span></div>
<div><br /></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">join</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 t3</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">on</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t1.year </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t3.year </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">and</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t1.month </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t3.month </span></div>
<div><br /></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">join</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 t4</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">on</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t1.year </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t4.year </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">and</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t1.month </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t4.month </span></div>
<div><br /></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">join</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 t5</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">on</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t1.year </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t5.year </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">and</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t1.month </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t5.month </span></div>
<div><br /></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">group</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">by</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t1.year</span></div>
<div><br /></div>
<div><span style="font-family: Times New Roman; font-size: 11pt; font-style: italic; color: #ff0000; background-color: #ffffff">--</span><span style="font-family: 宋体; font-size: 11pt; font-style: italic; color: #ff0000; background-color: #ffffff">这个多简单</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">year</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> amount </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp; table1 m </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">where</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">month</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">1</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp; </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">and</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> m.year</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #000000">aaa.year</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">as</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> m1</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> amount </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp; table1 m </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">where</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">month</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">2</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp; </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">and</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> m.year</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #000000">aaa.year</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">as</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> m2</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> amount </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp; table1 m </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">where</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">month</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">3</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp; </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">and</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> m.year</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #000000">aaa.year</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">as</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> m3</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> amount </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp; table1 m </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">where</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">month</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">4</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp; </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">and</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> m.year</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #000000">aaa.year</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">as</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> m4</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 aaa &nbsp; </span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">group</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">by</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">year</span></div>
<div><span style="font-family: Times New Roman; font-size: 11pt; font-style: italic; color: #ff0000; background-color: #ffffff">--</span><span style="font-family: 宋体; font-size: 11pt; font-style: italic; color: #ff0000; background-color: #ffffff">这个更简单</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">SELECT</span></div>
<div><span style="font-family: 宋体; font-size: 11pt"> &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">year</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span></div>
<div><span style="font-family: 宋体; font-size: 11pt"> &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">SUM</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">CASE</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">WHEN</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">month</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">1</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">THEN</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp;amount </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">ELSE</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: Times New Roman; font-size: 11pt; color: #0000ff">0</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">END</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">AS</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp;m1</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span></div>
<div><span style="font-family: 宋体; font-size: 11pt"> &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">SUM</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">CASE</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">WHEN</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">month</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">2</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">THEN</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp;amount </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">ELSE</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: Times New Roman; font-size: 11pt; color: #0000ff">0</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">END</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">AS</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp;m2</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span></div>
<div><span style="font-family: 宋体; font-size: 11pt"> &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">SUM</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">CASE</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">WHEN</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">month</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">3</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">THEN</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp;amount </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">ELSE</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: Times New Roman; font-size: 11pt; color: #0000ff">0</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">END</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">AS</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp;m3</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span></div>
<div><span style="font-family: 宋体; font-size: 11pt"> &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">SUM</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">CASE</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">WHEN</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">month</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">4</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">THEN</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp;amount </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">ELSE</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: Times New Roman; font-size: 11pt; color: #0000ff">0</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">END</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">AS</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp;m4</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">FROM</span></div>
<div><span style="font-family: 宋体; font-size: 11pt"> &nbsp;table1</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">GROUP</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">BY</span></div>
<div><span style="font-family: 宋体; font-size: 11pt"> &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">Year</span></div>
<div><br /></div>
<div><span style="font-family: Times New Roman; font-size: 11pt; font-style: italic; color: #ff0000">--</span><span style="font-family: 宋体; font-size: 11pt; font-style: italic; color: #ff0000">这个也行吗</span></div>
<div><span style="font-family: Arial; font-size: 11pt; color: #454545">select * from (select name, year b1, lead(year) over(partition by name order by year) b2, lead(m,2) over(partition by name order by year) b3,rank()over(partition by name order by year) rk from t) where rk=1;</span></div>
<div><br /></div>
<div><span style="font-family: 宋体; font-size: 10pt; color: #454545">1.用一条SQL语句查询出每门课都大于80分的学生姓名</span></div>
<div><span style="font-family: 宋体; font-size: 10pt">name &nbsp; &nbsp;张三</span><span style="font-family: Times New Roman; font-size: 10pt"> &nbsp; &nbsp; </span><span style="font-family: 宋体; font-size: 10pt">语文</span><span style="font-family: Times New Roman; font-size: 10pt"> &nbsp; &nbsp; &nbsp; </span><span style="font-family: 宋体; font-size: 10pt">81张三</span><span style="font-family: Times New Roman; font-size: 10pt"> &nbsp; &nbsp; </span><span style="font-family: 宋体; font-size: 10pt">数学</span><span style="font-family: Times New Roman; font-size: 10pt"> &nbsp; &nbsp; &nbsp; </span><span style="font-family: 宋体; font-size: 10pt">75李四</span><span style="font-family: Times New Roman; font-size: 10pt"> &nbsp; &nbsp; </span><span style="font-family: 宋体; font-size: 10pt">语文</span><span style="font-family: Times New Roman; font-size: 10pt"> &nbsp; &nbsp; &nbsp; </span><span style="font-family: 宋体; font-size: 10pt">76李四</span><span style="font-family: Times New Roman; font-size: 10pt"> &nbsp; &nbsp; </span><span style="font-family: 宋体; font-size: 10pt">数学</span><span style="font-family: Times New Roman; font-size: 10pt"> &nbsp; &nbsp; &nbsp; </span><span style="font-family: 宋体; font-size: 10pt">90王五</span><span style="font-family: Times New Roman; font-size: 10pt"> &nbsp; &nbsp; </span><span style="font-family: 宋体; font-size: 10pt">语文</span><span style="font-family: Times New Roman; font-size: 10pt"> &nbsp; &nbsp; &nbsp; </span><span style="font-family: 宋体; font-size: 10pt">81王五</span><span style="font-family: Times New Roman; font-size: 10pt"> &nbsp; &nbsp; </span><span style="font-family: 宋体; font-size: 10pt">数学</span><span style="font-family: Times New Roman; font-size: 10pt"> &nbsp; &nbsp; &nbsp; </span><span style="font-family: 宋体; font-size: 10pt">100王五</span><span style="font-family: Times New Roman; font-size: 10pt"> &nbsp; &nbsp; </span><span style="font-family: 宋体; font-size: 10pt">英语</span><span style="font-family: Times New Roman; font-size: 10pt"> &nbsp; &nbsp; &nbsp;</span><span style="font-family: Arial; font-size: 10pt"> </span><span style="font-family: 宋体; font-size: 10pt">90</span></div>
<div><br /></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080; background-color: #ffffff">create</span><span style="font-family: 宋体; font-size: 11pt; color: #000000; background-color: #ffffff"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080; background-color: #ffffff">table</span><span style="font-family: 宋体; font-size: 11pt; color: #000000; background-color: #ffffff"> table1</span><span style="font-family: 宋体; font-size: 11pt; color: #000080; background-color: #ffffff">(</span></div>
<div><span style="font-family: 宋体; font-size: 11pt"> &nbsp; &nbsp; &nbsp; </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">name</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">varchar2</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">4</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">),</span></div>
<div><span style="font-family: 宋体; font-size: 11pt"> &nbsp; &nbsp; &nbsp; course </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">varchar2</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">4</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">),</span></div>
<div><span style="font-family: 宋体; font-size: 11pt"> &nbsp; &nbsp; &nbsp; score </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">number</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">3</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span></div>
<div><br /></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">insert</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">into</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">values</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;张三&apos;</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;语文&apos;</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">81</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">);</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">insert</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">into</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">values</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;张三&apos;</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;数学&apos;</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">75</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">);</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">insert</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">into</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">values</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;李四&apos;</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;语文&apos;</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">76</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">);</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">insert</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">into</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">values</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;李四&apos;</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;数学&apos;</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">90</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">);</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">insert</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">into</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">values</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;王五&apos;</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;语文&apos;</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">81</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">);</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">insert</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">into</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">values</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;王五&apos;</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;数学&apos;</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">100</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">);</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">insert</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">into</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">values</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;王五&apos;</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;英语&apos;</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">90</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">);</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">commit</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">;</span></div>
<div><br /></div>
<div><span style="font-family: Times New Roman; font-size: 11pt; font-style: italic; color: #ff0000; background-color: #ffffff">--</span><span style="font-family: 宋体; font-size: 11pt; font-style: italic; color: #ff0000; background-color: #ffffff">某门课程大于80</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">name</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #000000">score </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 t1 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">where</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t1.score </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">&gt;</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">80</span></div>
<div><br /></div>
<div><span style="font-family: Times New Roman; font-size: 11pt; font-style: italic; color: #ff0000; background-color: #ffffff">--</span><span style="font-family: 宋体; font-size: 11pt; font-style: italic; color: #ff0000; background-color: #ffffff">所有课程大于80</span></div>
<div><br /></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">min</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #000000">score</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 t2 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">where</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t2.name </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;王五&apos;</span></div>
<div><br /></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">*</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 t1 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">where</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">min</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #000000">score</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 t2 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">where</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t2.name </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">&apos;王五&apos;</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)&gt;</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">80</span></div>
<div><span style="font-family: Times New Roman; font-size: 11pt; font-style: italic; color: #ff0000">--</span><span style="font-family: 宋体; font-size: 11pt; font-style: italic; color: #ff0000">问题1：不能写死成王五吧，使用相关子查询</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">*</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 t1 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">where</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">min</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #000000">score</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 t2 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">where</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t2.name </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #000000">t1.name</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">&gt;</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">80</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span></div>
<div><br /></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">name</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 t1 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">where</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">min</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #000000">score</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 t2 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">where</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t2.name </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #000000">t1.name</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">&gt;</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">80</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span></div>
<div><span style="font-family: Times New Roman; font-size: 11pt; font-style: italic; color: #ff0000">--</span><span style="font-family: 宋体; font-size: 11pt; font-style: italic; color: #ff0000">去除重复行</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">distinct</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">name</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 t1 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">where</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">min</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #000000">score</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 t2 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">where</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t2.name </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">=</span><span style="font-family: 宋体; font-size: 11pt; color: #000000">t1.name</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">&gt;</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">80</span></div>
<div><br /></div>
<div><span style="font-family: Times New Roman; font-size: 11pt; font-style: italic; color: #ff0000; background-color: #ffffff">--</span><span style="font-family: 宋体; font-size: 11pt; font-style: italic; color: #ff0000; background-color: #ffffff">更简单的方式</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> &nbsp;</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">distinct</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">name</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">where</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">name</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">not</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">in</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">distinct</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">name</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">where</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> score</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">&lt;=</span><span style="font-family: 宋体; font-size: 11pt; color: #0000ff">80</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span></div>
<div><br /></div>
<div><br /></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #454545">表形式如下：</span><span style="font-family: Times New Roman; font-size: 11pt; color: #454545"> </span><span style="font-family: Arial; font-size: 11pt; color: #454545">Year &nbsp; &nbsp; Salary 2000 &nbsp; &nbsp; &nbsp; 1000 2001 &nbsp; &nbsp; &nbsp; 2000 2002 &nbsp; &nbsp; &nbsp; 3000 2003 &nbsp; &nbsp; &nbsp; 4000 </span><span style="font-family: 宋体; font-size: 11pt; color: #454545">想得到如下形式的查询结果</span><span style="font-family: Times New Roman; font-size: 11pt; color: #454545"> </span><span style="font-family: Arial; font-size: 11pt; color: #454545">Year &nbsp; &nbsp; Salary 2000 &nbsp; &nbsp; 1000 2001 &nbsp; &nbsp; 3000 2002 &nbsp; &nbsp; 6000 2003 &nbsp; &nbsp; 10000 sql</span><span style="font-family: 宋体; font-size: 11pt; color: #454545">语句怎么写</span><span style="font-family: Arial; font-size: 11pt; color: #454545">? </span></div>
<div><span style="font-family: 宋体; font-size: 11pt; font-style: italic; color: #ff0000; background-color: #ffffff">方法1：自关联</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t2.year</span><span style="font-family: Times New Roman; font-size: 11pt; color: #000080">,</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">sum</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #000000">t1.salary</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 t1</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">join</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 t2</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">on</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t1.year </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">&lt;=</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t2.year</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">group</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">by</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t2.year</span></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">order</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">by</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t2.year</span></div>
<div><br /></div>
<div><span style="font-family: 宋体; font-size: 11pt; font-style: italic; color: #ff0000; background-color: #ffffff">方法2-子查询</span></div>
<div><br /></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">year</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">,(</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">sum</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #000000">salary</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 &nbsp;t2 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">where</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t2.year</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">&lt;=</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">year</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> salary </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1</span></div>
<div><br /></div>
<div><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t1.year </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">,(</span><span style="font-family: 宋体; font-size: 11pt; color: #008080">select</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">sum</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">(</span><span style="font-family: 宋体; font-size: 11pt; color: #000000">salary</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 &nbsp;t2 </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">where</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> t2.year</span><span style="font-family: 宋体; font-size: 11pt; color: #000080">&lt;=</span><span style="font-family: 宋体; font-size: 11pt; color: #000000">t1.year </span><span style="font-family: 宋体; font-size: 11pt; color: #000080">)</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> salary </span><span style="font-family: 宋体; font-size: 11pt; color: #008080">from</span><span style="font-family: 宋体; font-size: 11pt; color: #000000"> table1 &nbsp;t1</span></div>
<div><br /></div>
<div><br /></div>
<div><br /></div>
<div id="ID_Footer" style="text-align: right; margin-top: 4em; padding-top: 4px; border-top: 2px solid gray">Generated with <a href="http://www.wjjsoft.com/mybase#htmltree" target="_blank">myBase/HtmlTree Maker</a> by <a href="http://www.wjjsoft.com/#htmltree" target="_blank">Wjj Software</a></div><script type="text/javascript" language="javascript" src="jquery.js;itemlink.js"></script>
<script type="text/javascript" language="javascript" src="jquery.js"></script>
<script type="text/javascript" language="javascript" src="itemlink.js"></script></body></html>