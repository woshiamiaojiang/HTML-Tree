<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<style>
			table{border-collapse: collapse; border: 1px solid gray; border-width: 2px 1px 2px 1px;}
			th{border: 1px solid gray; padding: 4px; background-color: #ddd;}
			td{border: 1px solid gray; padding: 4px;}
			tr:nth-child(2n){background-color: #f8f8f8;}
			pre{border: 2px solid #d6d6d6; padding: 0px; border-radius: 3px;}
		</style>
	</head>
	<body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; ">
		<div><img src="data:image/png;base64,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" />
		</div>
		<div>
			<meta http-equiv="content-type" content="text/html; charset=utf-8" />
			<pre style="background-color:#ffffff;color:#000000;font-family:'Consolas';font-size:13.5pt;">
<span style="color:#000080;font-weight:bold;">package </span>com.imooc.sell.dto;<br><br><span style="color:#000080;font-weight:bold;">import </span>lombok.<span style="color:#808000;">Data</span>;<br><br><span style="color:#008000;font-weight:bold;">/**<br></span><span style="color:#008000;font-weight:bold;"> * </span><span style="color:#008000;font-weight:bold;font-family:'宋体';">购物车<br></span><span style="color:#008000;font-weight:bold;font-family:'宋体';"> </span><span style="color:#008000;font-weight:bold;">* Created by 80003415<br></span><span style="color:#008000;font-weight:bold;"> * 2018-08-18 17:33<br></span><span style="color:#008000;font-weight:bold;"> */<br></span><span style="color:#808000;">@Data<br></span><span style="color:#000080;font-weight:bold;">public class </span>CartDTO {<br><br>    <span style="color:#008000;font-weight:bold;">/** </span><span style="color:#008000;font-weight:bold;font-family:'宋体';">商品</span><span style="color:#008000;font-weight:bold;">ID. */<br></span><span style="color:#008000;font-weight:bold;">    </span><span style="color:#000080;font-weight:bold;">private </span>String <span style="color:#660e7a;font-weight:bold;">productId</span>;<br><br>    <span style="color:#008000;font-weight:bold;">/** </span><span style="color:#008000;font-weight:bold;font-family:'宋体';">数量</span><span style="color:#008000;font-weight:bold;">. */<br></span><span style="color:#008000;font-weight:bold;">    </span><span style="color:#000080;font-weight:bold;">private </span>Integer <span style="color:#660e7a;font-weight:bold;">productQuantity</span>;<br><br>    <span style="color:#000080;font-weight:bold;">public </span>CartDTO(String productId, Integer productQuantity) {<br>        <span style="color:#000080;font-weight:bold;">this</span>.<span style="color:#660e7a;font-weight:bold;">productId </span>= productId;<br>        <span style="color:#000080;font-weight:bold;">this</span>.<span style="color:#660e7a;font-weight:bold;">productQuantity </span>= productQuantity;<br>    }<br>}<br></pre>
		</div>
		<div><img src="data:image/png;base64,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" />
		</div>
		<div>
			<meta http-equiv="content-type" content="text/html; charset=utf-8" />
			<pre style="background-color:#ffffff;color:#000000;font-family:'Consolas';font-size:13.5pt;">
<span style="color:#000080;font-weight:bold;">package </span>com.imooc.sell.service;<br><br><span style="color:#000080;font-weight:bold;">import </span>com.imooc.sell.dataobject.ProductInfo;<br><span style="color:#000080;font-weight:bold;">import </span>com.imooc.sell.dto.CartDTO;<br><span style="color:#000080;font-weight:bold;">import </span>org.springframework.data.domain.Page;<br><span style="color:#000080;font-weight:bold;">import </span>org.springframework.data.domain.Pageable;<br><br><span style="color:#000080;font-weight:bold;">import </span>java.util.List;<br><br><span style="color:#008000;font-weight:bold;">/**<br></span><span style="color:#008000;font-weight:bold;"> * </span><span style="color:#008000;font-weight:bold;font-family:'宋体';">商品<br></span><span style="color:#008000;font-weight:bold;font-family:'宋体';"> </span><span style="color:#008000;font-weight:bold;">* Created by 80003415<br></span><span style="color:#008000;font-weight:bold;"> * 2018-08-13 17:10<br></span><span style="color:#008000;font-weight:bold;"> */<br></span><span style="color:#000080;font-weight:bold;">public interface </span>ProductService {<br><br>    ProductInfo findOne(String productId);<br><br>    <span style="color:#008000;font-weight:bold;">/**<br></span><span style="color:#008000;font-weight:bold;">     * </span><span style="color:#008000;font-weight:bold;font-family:'宋体';">查询所有<br></span><span style="color:#008000;font-weight:bold;font-family:'宋体';">     </span><span style="color:#008000;font-weight:bold;">* @return<br></span><span style="color:#008000;font-weight:bold;">     */<br></span><span style="color:#008000;font-weight:bold;">    </span>List&lt;ProductInfo&gt; findUpAll();<br><br>    Page&lt;ProductInfo&gt; findAll(Pageable pageable);<br><br>    ProductInfo save(ProductInfo productInfo);<br><br>    <span style="color:#008000;font-weight:bold;">// </span><span style="color:#008000;font-weight:bold;font-family:'宋体';">加库存<br></span><span style="color:#008000;font-weight:bold;font-family:'宋体';">    </span><span style="color:#000080;font-weight:bold;">void </span>increaseStock(List&lt;CartDTO&gt; cartDTOList);<br><br>    <span style="color:#008000;font-weight:bold;">// </span><span style="color:#008000;font-weight:bold;font-family:'宋体';">减库存<br></span><span style="color:#008000;font-weight:bold;font-family:'宋体';">    </span><span style="color:#000080;font-weight:bold;">void </span>decreaseStock(List&lt;CartDTO&gt; cartDTOList);<br>}<br></pre>
		</div>
		<div><img src="data:image/png;base64,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" />
		</div>
		<div>
			<meta http-equiv="content-type" content="text/html; charset=utf-8" />
			<pre style="background-color:#ffffff;color:#000000;font-family:'Consolas';font-size:13.5pt;">
<span style="color:#000080;font-weight:bold;">package </span>com.imooc.sell.enums;<br><br><span style="color:#000080;font-weight:bold;">import </span>lombok.<span style="color:#808000;">Getter</span>;<br><br><span style="color:#008000;font-weight:bold;">/**<br></span><span style="color:#008000;font-weight:bold;"> * Created by 80003415<br></span><span style="color:#008000;font-weight:bold;"> * 2018-08-18 9:49<br></span><span style="color:#008000;font-weight:bold;"> */<br></span><span style="color:#808000;">@Getter<br></span><span style="color:#000080;font-weight:bold;">public enum </span>ResultEnum <span style="background-color:#f6ebbc;">{<br></span><span style="background-color:#f6ebbc;"><br></span><span style="background-color:#f6ebbc;">    PRODUCT_NOT_EXIT(</span><span style="color:#0000ff;background-color:#f6ebbc;">10</span><span style="background-color:#f6ebbc;">, </span><span style="color:#008000;background-color:#f6ebbc;font-weight:bold;">"</span><span style="color:#008000;background-color:#f6ebbc;font-weight:bold;font-family:'宋体';">商品不存在</span><span style="color:#008000;background-color:#f6ebbc;font-weight:bold;">"</span><span style="background-color:#f6ebbc;">),<br></span><span style="background-color:#f6ebbc;"><br></span><span style="background-color:#f6ebbc;">    PRODUCT_STOCK_ERROR(</span><span style="color:#0000ff;background-color:#f6ebbc;">11</span><span style="background-color:#f6ebbc;">, </span><span style="color:#008000;background-color:#f6ebbc;font-weight:bold;">"</span><span style="color:#008000;background-color:#f6ebbc;font-weight:bold;font-family:'宋体';">商品库存不正确</span><span style="color:#008000;background-color:#f6ebbc;font-weight:bold;">"</span><span style="background-color:#f6ebbc;">),<br></span><span style="background-color:#f6ebbc;">    ;<br></span><span style="background-color:#f6ebbc;"><br></span><span style="background-color:#f6ebbc;">    </span><span style="color:#000080;background-color:#f6ebbc;font-weight:bold;">private </span><span style="background-color:#f6ebbc;">Integer code;<br></span><span style="background-color:#f6ebbc;"><br></span><span style="background-color:#f6ebbc;">    </span><span style="color:#000080;background-color:#f6ebbc;font-weight:bold;">private </span><span style="background-color:#f6ebbc;">String message;<br></span><span style="background-color:#f6ebbc;"><br></span><span style="background-color:#f6ebbc;">    ResultEnum(Integer i, String message) {<br></span><span style="background-color:#f6ebbc;">        </span><span style="color:#000080;background-color:#f6ebbc;font-weight:bold;">this</span><span style="background-color:#f6ebbc;">.code = code;<br></span><span style="background-color:#f6ebbc;">        </span><span style="color:#000080;background-color:#f6ebbc;font-weight:bold;">this</span><span style="background-color:#f6ebbc;">.message = message;<br></span><span style="background-color:#f6ebbc;">    }<br></span><span style="background-color:#f6ebbc;">}</span><br></pre>
		</div>
		<div><img src="data:image/png;base64,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" />
		</div>
		<div>
			<meta http-equiv="content-type" content="text/html; charset=utf-8" />
			<pre style="background-color:#ffffff;color:#000000;font-family:'Consolas';font-size:13.5pt;">
<span style="color:#000080;font-weight:bold;">package </span>com.imooc.sell.service.impl;<br><br><span style="color:#000080;font-weight:bold;">import </span>com.imooc.sell.dataobject.OrderDetail;<br><span style="color:#000080;font-weight:bold;">import </span>com.imooc.sell.dataobject.OrderMaster;<br><span style="color:#000080;font-weight:bold;">import </span>com.imooc.sell.dataobject.ProductInfo;<br><span style="color:#000080;font-weight:bold;">import </span>com.imooc.sell.dto.CartDTO;<br><span style="color:#000080;font-weight:bold;">import </span>com.imooc.sell.dto.OrderDTO;<br><span style="color:#000080;font-weight:bold;">import </span>com.imooc.sell.enums.ResultEnum;<br><span style="color:#000080;font-weight:bold;">import </span>com.imooc.sell.exception.SellException;<br><span style="color:#000080;font-weight:bold;">import </span>com.imooc.sell.repository.OrderDetailRepository;<br><span style="color:#000080;font-weight:bold;">import </span>com.imooc.sell.repository.OrderMasterRepository;<br><span style="color:#000080;font-weight:bold;">import </span>com.imooc.sell.service.OrderService;<br><span style="color:#000080;font-weight:bold;">import </span>com.imooc.sell.service.ProductService;<br><span style="color:#000080;font-weight:bold;">import </span>com.imooc.sell.utils.KeyUtil;<br><span style="color:#000080;font-weight:bold;">import </span>org.springframework.beans.BeanUtils;<br><span style="color:#000080;font-weight:bold;">import </span>org.springframework.beans.factory.annotation.<span style="color:#808000;">Autowired</span>;<br><span style="color:#000080;font-weight:bold;">import </span>org.springframework.data.domain.Page;<br><span style="color:#000080;font-weight:bold;">import </span>org.springframework.data.domain.Pageable;<br><span style="color:#000080;font-weight:bold;">import </span>org.springframework.stereotype.<span style="color:#808000;">Service</span>;<br><span style="color:#000080;font-weight:bold;">import </span>org.springframework.transaction.annotation.<span style="color:#808000;">Transactional</span>;<br><br><span style="color:#000080;font-weight:bold;">import </span>java.math.BigDecimal;<br><span style="color:#000080;font-weight:bold;">import </span>java.math.BigInteger;<br><span style="color:#000080;font-weight:bold;">import </span>java.util.List;<br><span style="color:#000080;font-weight:bold;">import </span>java.util.stream.Collectors;<br><br><span style="color:#008000;font-weight:bold;">/**<br></span><span style="color:#008000;font-weight:bold;"> * Created by 80003415<br></span><span style="color:#008000;font-weight:bold;"> * 2018-08-18 9:27<br></span><span style="color:#008000;font-weight:bold;"> */<br></span><span style="color:#808000;">@Service<br></span><span style="color:#000080;font-weight:bold;">public class </span>OrderServiceImpl <span style="color:#000080;font-weight:bold;">implements </span>OrderService {<br><br>    <span style="color:#808000;">@Autowired<br></span><span style="color:#808000;">    </span><span style="color:#000080;font-weight:bold;">private </span>ProductService <span style="color:#660e7a;font-weight:bold;">productService</span>;<br><br>    <span style="color:#808000;">@Autowired<br></span><span style="color:#808000;">    </span><span style="color:#000080;font-weight:bold;">private </span>OrderDetailRepository <span style="color:#660e7a;font-weight:bold;">orderDetailRepository</span>;<br><br>    <span style="color:#808000;">@Autowired<br></span><span style="color:#808000;">    </span><span style="color:#000080;font-weight:bold;">private </span>OrderMasterRepository <span style="color:#660e7a;font-weight:bold;">orderMasterRepository</span>;<br><br>    <span style="color:#808000;">@Override<br></span><span style="color:#808000;">    @Transactional </span><span style="color:#008000;font-weight:bold;">// </span><span style="color:#008000;font-weight:bold;font-family:'宋体';">如果错误，事务回滚，不进行任何错误<br></span><span style="color:#008000;font-weight:bold;font-family:'宋体';">    </span><span style="color:#000080;font-weight:bold;">public </span>OrderDTO create(OrderDTO orderDTO) {<br><br>        String orderId = KeyUtil.<span style="font-style:italic;">genUniqueKey</span>();<br><br>        BigDecimal orderAmount = <span style="color:#000080;font-weight:bold;">new </span>BigDecimal(BigInteger.<span style="color:#660e7a;font-weight:bold;font-style:italic;">ZERO</span>);<br><br><span style="color:#008000;font-weight:bold;">//        List&lt;CartDTO&gt; cartDTOList = new ArrayList&lt;&gt;();<br></span><span style="color:#008000;font-weight:bold;"><br></span><span style="color:#008000;font-weight:bold;">        //1. </span><span style="color:#008000;font-weight:bold;font-family:'宋体';">查询商品</span><span style="color:#008000;font-weight:bold;"> (</span><span style="color:#008000;font-weight:bold;font-family:'宋体';">数量</span><span style="color:#008000;font-weight:bold;">, </span><span style="color:#008000;font-weight:bold;font-family:'宋体';">价格</span><span style="color:#008000;font-weight:bold;">)<br></span><span style="color:#008000;font-weight:bold;">        </span><span style="color:#000080;font-weight:bold;">for </span>(OrderDetail orderDetail : orderDTO.getOrderDetailList()) {<br>            ProductInfo productInfo = <span style="color:#660e7a;font-weight:bold;">productService</span>.findOne(orderDetail.getProductId());<br>            <span style="color:#000080;font-weight:bold;">if </span>(productInfo == <span style="color:#000080;font-weight:bold;">null</span>) {<br>                <span style="color:#000080;font-weight:bold;">throw new </span>SellException(ResultEnum.<span style="color:#660e7a;font-weight:bold;font-style:italic;">PRODUCT_NOT_EXIT</span>);<br>            }<br><br>            <span style="color:#008000;font-weight:bold;">//2. </span><span style="color:#008000;font-weight:bold;font-family:'宋体';">计算订单总价<br></span><span style="color:#008000;font-weight:bold;font-family:'宋体';">            </span>orderAmount = orderDetail.getProductPrice()<br>                    .multiply(<span style="color:#000080;font-weight:bold;">new </span>BigDecimal(orderDetail.getProductQuantity()))<br>                    .add(orderAmount);<br><br>            <span style="color:#008000;font-weight:bold;">//3. </span><span style="color:#008000;font-weight:bold;font-family:'宋体';">订单详情入库</span><span style="color:#008000;font-weight:bold;"> (orderDetail)<br></span><span style="color:#008000;font-weight:bold;">            </span>orderDetail.setDetailId(KeyUtil.<span style="font-style:italic;">genUniqueKey</span>());<br>            orderDetail.setOrderId(orderId);<br>            <span style="color:#008000;font-weight:bold;">// orderDetail.setProductName(productInfo.getProductName());<br></span><span style="color:#008000;font-weight:bold;">            // Spring</span><span style="color:#008000;font-weight:bold;font-family:'宋体';">的方法。进行对象的属性拷贝<br></span><span style="color:#008000;font-weight:bold;font-family:'宋体';">            </span>BeanUtils.<span style="font-style:italic;">copyProperties</span>(productInfo, orderDetail);<br>            <span style="color:#660e7a;font-weight:bold;">orderDetailRepository</span>.save(orderDetail);<br><br><span style="color:#008000;font-weight:bold;">//            CartDTO cartDTO = new CartDTO(orderDetail.getProductId(), orderDetail.getProductQuantity());<br></span><span style="color:#008000;font-weight:bold;">//            cartDTOList.add(cartDTO);<br></span><span style="color:#008000;font-weight:bold;">        </span>}<br><br>        <span style="color:#008000;font-weight:bold;">//3. </span><span style="color:#008000;font-weight:bold;font-family:'宋体';">写入订单数据库</span><span style="color:#008000;font-weight:bold;"> (orderMaster)<br></span><span style="color:#008000;font-weight:bold;">        </span>OrderMaster orderMaster = <span style="color:#000080;font-weight:bold;">new </span>OrderMaster();<br>        orderMaster.setOrderId(orderId);<br>        orderMaster.setOrderAmount(orderAmount);<br>        BeanUtils.<span style="font-style:italic;">copyProperties</span>(orderDTO, orderMaster);<br>        <span style="color:#660e7a;font-weight:bold;">orderMasterRepository</span>.save(orderMaster);<br><br>        <span style="color:#008000;font-weight:bold;">//4. </span><span style="color:#008000;font-weight:bold;font-family:'宋体';">扣库存<br></span><span style="color:#008000;font-weight:bold;font-family:'宋体';">        </span>List&lt;CartDTO&gt; cartDTOList = orderDTO.getOrderDetailList().stream().map(e -&gt;<br>                <span style="color:#000080;font-weight:bold;">new </span>CartDTO(e.getProductId(), e.getProductQuantity())<br>        ).collect(Collectors.<span style="font-style:italic;">toList</span>());<br>        <span style="color:#660e7a;font-weight:bold;">productService</span>.decreaseStock(cartDTOList);<br><br>        <span style="color:#000080;font-weight:bold;">return </span>orderDTO;<br>    }<br><br>    <span style="color:#808000;">@Override<br></span><span style="color:#808000;">    </span><span style="color:#000080;font-weight:bold;">public </span>OrderDTO findOne(String orderId) {<br>        <span style="color:#000080;font-weight:bold;">return null</span>;<br>    }<br><br>    <span style="color:#808000;">@Override<br></span><span style="color:#808000;">    </span><span style="color:#000080;font-weight:bold;">public </span>Page&lt;OrderDTO&gt; findList(String buyerOpenid, Pageable pageable) {<br>        <span style="color:#000080;font-weight:bold;">return null</span>;<br>    }<br><br>    <span style="color:#808000;">@Override<br></span><span style="color:#808000;">    </span><span style="color:#000080;font-weight:bold;">public </span>OrderDTO cancel(OrderDTO orderDTO) {<br>        <span style="color:#000080;font-weight:bold;">return null</span>;<br>    }<br><br>    <span style="color:#808000;">@Override<br></span><span style="color:#808000;">    </span><span style="color:#000080;font-weight:bold;">public </span>OrderDTO finish(OrderDTO orderDTO) {<br>        <span style="color:#000080;font-weight:bold;">return null</span>;<br>    }<br><br>    <span style="color:#808000;">@Override<br></span><span style="color:#808000;">    </span><span style="color:#000080;font-weight:bold;">public </span>OrderDTO paid(OrderDTO orderDTO) {<br>        <span style="color:#000080;font-weight:bold;">return null</span>;<br>    }<br>}<br></pre>
		</div>
		<div><img src="data:image/png;base64,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" />
		</div>
		<div>
			<meta http-equiv="content-type" content="text/html; charset=utf-8" />
			<pre style="background-color:#ffffff;color:#000000;font-family:'Consolas';font-size:13.5pt;">
<span style="color:#000080;font-weight:bold;">package </span>com.imooc.sell.service.impl;<br><br><span style="color:#000080;font-weight:bold;">import </span>com.imooc.sell.dataobject.ProductInfo;<br><span style="color:#000080;font-weight:bold;">import </span>com.imooc.sell.dto.CartDTO;<br><span style="color:#000080;font-weight:bold;">import </span>com.imooc.sell.enums.ProductStatusEnum;<br><span style="color:#000080;font-weight:bold;">import </span>com.imooc.sell.enums.ResultEnum;<br><span style="color:#000080;font-weight:bold;">import </span>com.imooc.sell.exception.SellException;<br><span style="color:#000080;font-weight:bold;">import </span>com.imooc.sell.repository.ProductInfoRepository;<br><span style="color:#000080;font-weight:bold;">import </span>com.imooc.sell.service.ProductService;<br><span style="color:#000080;font-weight:bold;">import </span>org.springframework.beans.factory.annotation.<span style="color:#808000;">Autowired</span>;<br><span style="color:#000080;font-weight:bold;">import </span>org.springframework.data.domain.Page;<br><span style="color:#000080;font-weight:bold;">import </span>org.springframework.data.domain.Pageable;<br><span style="color:#000080;font-weight:bold;">import </span>org.springframework.stereotype.<span style="color:#808000;">Service</span>;<br><span style="color:#000080;font-weight:bold;">import </span>org.springframework.transaction.annotation.<span style="color:#808000;">Transactional</span>;<br><br><span style="color:#000080;font-weight:bold;">import </span>java.util.List;<br><br><span style="color:#008000;font-weight:bold;">/**<br></span><span style="color:#008000;font-weight:bold;"> * Created by 80003415<br></span><span style="color:#008000;font-weight:bold;"> * 2018-08-13 17:25<br></span><span style="color:#008000;font-weight:bold;"> */<br></span><span style="color:#808000;">@Service<br></span><span style="color:#000080;font-weight:bold;">public class </span>ProductServiceImpl <span style="color:#000080;font-weight:bold;">implements </span>ProductService {<br><br>    <span style="color:#808000;">@Autowired<br></span><span style="color:#808000;">    </span><span style="color:#000080;font-weight:bold;">private </span>ProductInfoRepository <span style="color:#660e7a;font-weight:bold;">repository</span>;<br><br>    <span style="color:#808000;">@Override<br></span><span style="color:#808000;">    </span><span style="color:#000080;font-weight:bold;">public </span>ProductInfo findOne(String productId) {<br>        <span style="color:#000080;font-weight:bold;">return </span><span style="color:#660e7a;font-weight:bold;">repository</span>.findOne(productId);<br>    }<br><br>    <span style="color:#808000;">@Override<br></span><span style="color:#808000;">    </span><span style="color:#000080;font-weight:bold;">public </span>List&lt;ProductInfo&gt; findUpAll() {<br>        <span style="color:#000080;font-weight:bold;">return </span><span style="color:#660e7a;font-weight:bold;">repository</span>.findByProductStatus(ProductStatusEnum.<span style="color:#660e7a;font-weight:bold;font-style:italic;">UP</span>.getCode());<br>    }<br><br>    <span style="color:#808000;">@Override<br></span><span style="color:#808000;">    </span><span style="color:#000080;font-weight:bold;">public </span>Page&lt;ProductInfo&gt; findAll(Pageable pageable) {<br>        <span style="color:#000080;font-weight:bold;">return </span><span style="color:#660e7a;font-weight:bold;">repository</span>.findAll(pageable);<br>    }<br><br>    <span style="color:#808000;">@Override<br></span><span style="color:#808000;">    </span><span style="color:#000080;font-weight:bold;">public </span>ProductInfo save(ProductInfo productInfo) {<br>        <span style="color:#000080;font-weight:bold;">return </span><span style="color:#660e7a;font-weight:bold;">repository</span>.save(productInfo);<br>    }<br><br>    <span style="color:#808000;">@Override<br></span><span style="color:#808000;">    </span><span style="color:#000080;font-weight:bold;">public void </span>increaseStock(List&lt;CartDTO&gt; cartDTOList) {<br><br>    }<br><br>    <span style="color:#808000;">@Override<br></span><span style="color:#808000;">    @Transactional<br></span><span style="color:#808000;">    </span><span style="color:#000080;font-weight:bold;">public void </span>decreaseStock(List&lt;CartDTO&gt; cartDTOList) {<br>        <span style="color:#000080;font-weight:bold;">for </span>(CartDTO cartDTO : cartDTOList) {<br>            ProductInfo productInfo = <span style="color:#660e7a;font-weight:bold;">repository</span>.findOne(cartDTO.getProductId());<br>            <span style="color:#000080;font-weight:bold;">if </span>(productInfo == <span style="color:#000080;font-weight:bold;">null</span>) {<br>                <span style="color:#000080;font-weight:bold;">throw new </span>SellException(ResultEnum.<span style="color:#660e7a;font-weight:bold;font-style:italic;">PRODUCT_NOT_EXIT</span>);<br>            }<br><br>            Integer result = productInfo.getProductStock() - cartDTO.getProductQuantity();<br>            <span style="color:#000080;font-weight:bold;">if </span>(result &lt; <span style="color:#0000ff;">0</span>) {<br>                <span style="color:#000080;font-weight:bold;">throw new </span>SellException(ResultEnum.<span style="color:#660e7a;font-weight:bold;font-style:italic;">PRODUCT_STOCK_ERROR</span>);<br>            }<br><br>            productInfo.setProductStock(result);<br><br>            <span style="color:#660e7a;font-weight:bold;">repository</span>.save(productInfo);<br>        }<br>    }<br>}<br></pre>
		</div>
		<div><br />
		</div>
		<div><br />
		</div>
		<div><br />
		</div>
		<div><br />
		</div>
		<div><br />
		</div>
		<div><br />
		</div>
		<div><br />
		</div>
		<div><br />
		</div>
		<div><br />
		</div>
		<div><br />
		</div>
		<div><br />
		</div>
		<div><br />
		</div>
		<div><br />
		</div>
		<div><br />
		</div>
		<div><br />
		</div>
		<div><br />
		</div>
	
<script type="text/javascript" language="javascript" src="jquery.js"></script>
<script type="text/javascript" language="javascript" src="itemlink.js"></script></body>
</html>